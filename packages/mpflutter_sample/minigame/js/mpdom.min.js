"use strict";var __extends=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),__assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},__assign.apply(this,arguments)},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{l(i.next(t))}catch(t){r(t)}}function a(t){try{l(i.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}l((i=i.apply(t,e||[])).next())}))},__generator=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).MPDOM=t()}}((function(){var define,module,exports;return function t(e,n,i){function o(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};e[s][0].call(u.exports,(function(t){return o(e[s][1][t]||t)}),u,u.exports,t,e,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.BrowserApp=void 0;var i=t("./platform_channel/plugin_register"),o=t("./platform_channel/mp_method_channel"),r=t("./page"),s=t("./router"),a=function(){function t(t,e){this.rootElement=t,this.engine=e,this.router=new l(this.engine),e.app=this,this.setupPageScrollListener()}return t.prototype.setupPageScrollListener=function(){var t=this;document.addEventListener("scroll",(function(){var e;if(document.documentElement.scrollHeight>innerHeight&&window.pageYOffset+innerHeight>=document.documentElement.scrollHeight){var n=(null===(e=t.engine.app)||void 0===e?void 0:e.router).history;n[n.length-1].item.onReachBottom()}}))},t.prototype.getURLSearchParams=function(){try{for(var t={},e=new URL(window.location.href).searchParams,n=e.keys(),i=n.next();!i.done&&(t[i.value]=e.get(i.value),!(i=n.next()).done););return t}catch(t){return console.error(t),{}}},t.prototype.setupFirstPage=function(t,e){var n,i;return __awaiter(this,void 0,void 0,(function(){var o,s;return __generator(this,(function(a){switch(a.label){case 0:return t||(this.router.isPathRewriteEnabled?t={route:new URL(window.location.href).pathname||"/",params:this.getURLSearchParams()}:(delete(o=__assign({},this.getURLSearchParams())).route,t={route:new URL(window.location.href).searchParams.get("route")||"/",params:o})),(s=new r.Page(this.rootElement,this.engine,t)).isFirst=!0,e?(this.router.history.forEach((function(t){return t.item.active=!1})),this.router.history[0]={item:s,scrollPosition:0}):this.router.history.push({item:s,scrollPosition:0}),[4,s.ready()];case 1:return a.sent(),this.router.didSetupFirst(s.viewId,null!==(n=null==t?void 0:t.route)&&void 0!==n?n:"/",null!==(i=null==t?void 0:t.params)&&void 0!==i?i:{}),[2]}}))}))},t.prototype.enablePathRewrite=function(){this.router.isPathRewriteEnabled=!0},t}();n.BrowserApp=a;var l=function(t){function e(e){var n=t.call(this,e)||this;return n.history=[],n.isPathRewriteEnabled=!1,n.doBacking=!1,window.addEventListener("popstate",(function(t){if(n.doBacking)return!0;if(window.history.state&&window.history.state.routeId){var e=window.history.state.routeId;n.history.length>1?(n.popHistory(),n.engine.sendMessage(JSON.stringify({type:"router",message:{event:"popToRoute",routeId:e}}))):n.engine.app&&n.engine.app instanceof a&&n.engine.app.setupFirstPage(void 0,!0)}})),n}return __extends(e,t),e.prototype.encodePath=function(t,e){var n=[];if(e)for(var i in e)n.push("".concat(i,"=").concat(encodeURIComponent(e[i])));if(this.isPathRewriteEnabled)return n.length>0?"".concat(t,"?").concat(n.join("&")):"".concat(t);var o=t.indexOf("?")>=0?t.split("?")[0]:t,r=t.indexOf("?")>=0?t.substr(t.indexOf("?")):"";return n.length>0?"?route=".concat(encodeURI(o)).concat(encodeURIComponent(r),"&").concat(n.join("&")):"?route=".concat(encodeURI(o)).concat(encodeURIComponent(r))},e.prototype.didSetupFirst=function(t,e,n){window.history.replaceState({routeId:t},"",this.encodePath(e,n))},e.prototype.didPush=function(t){var e=t.routeId;this.thePushingRouteId=e;var n=t.name;window.history.pushState({routeId:e},"",this.encodePath(n,t.params));var i=window.pageYOffset,o=new r.Page(this.engine.app.rootElement,this.engine);this.pushHistory(o,i)},e.prototype.didReplace=function(t){var e=t.routeId;this.thePushingRouteId=e;var n=t.name;window.history.replaceState({routeId:e},"",this.encodePath(n,t.params));var i=new r.Page(this.engine.app.rootElement,this.engine);this.replaceHistory(i)},e.prototype.didPop=function(){var t=this;this.doBacking=!0,window.history.back(),this.popHistory(),setTimeout((function(){t.doBacking=!1}),100)},e.prototype.pushHistory=function(t,e){this.history.forEach((function(t){return t.item.active=!1})),this.history.push({item:t,scrollPosition:e}),window.scrollTo(0,0)},e.prototype.replaceHistory=function(t){this.history.forEach((function(t){return t.item.active=!1})),this.history[this.history.length-1]={item:t,scrollPosition:0},window.scrollTo(0,0)},e.prototype.popHistory=function(){this.history.length<=1||(this.history.pop().item.active=!1,this.history[this.history.length-1].item.active=!0,window.scrollTo(0,this.history[this.history.length-1].scrollPosition))},e}(s.Router),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onMethodCall=function(t,e){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(i){if("Clipboard.setData"===t)return n=document.createElement("input"),document.body.appendChild(n),n.value=e.text,n.select(),document.execCommand("Copy"),n.remove(),[2,null];if("Clipboard.getData"===t)throw"The operation of getData from clip board is not allow in browser.";if("RootBundle.getAssets"===t)return[2,new Promise((function(t,n){var i=new XMLHttpRequest;i.responseType="blob",i.open("GET","/assets/".concat(decodeURIComponent(e.uri))),i.onloadend=function(){var e=new FileReader;e.onloadend=function(){t(e.result.split("base64,")[1])},e.readAsDataURL(i.response)},i.onerror=function(){n(i.statusText)},i.send()}))];throw"NOTIMPLEMENTED"}))}))},e}(o.MPMethodChannel);i.PluginRegister.registerChannel("flutter/platform",c)},{"./page":64,"./platform_channel/mp_method_channel":66,"./platform_channel/plugin_register":68,"./router":69}],2:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasApp=void 0;var i=t("./canvaskit/canvas_page"),o=t("./router"),r=function(){function t(t,e){this.canvasContext=t,this.engine=e,this.router=new s(this.engine),e.app=this}return t.prototype.setupFirstPage=function(t,e){return __awaiter(this,void 0,void 0,(function(){var t;return __generator(this,(function(e){switch(e.label){case 0:return t=new i.CanvasPage(this.canvasContext,this.engine),this.currentPage=t,[4,t.ready()];case 1:return e.sent(),[2]}}))}))},t}();n.CanvasApp=r;var s=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e}(o.Router)},{"./canvaskit/canvas_page":12,"./router":69}],3:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClipOval=void 0;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.roundRect=function(t,e,n,i,o,r,s){void 0===s&&(s="transparent"),i<2*r&&(r=i/2),o<2*r&&(r=o/2),t.beginPath(),t.fillStyle=s,t.arc(e+r,n+r,r,Math.PI,1.5*Math.PI),t.moveTo(e+r,n),t.lineTo(e+i-r,n),t.lineTo(e+i,n+r),t.arc(e+i-r,n+r,r,1.5*Math.PI,2*Math.PI),t.lineTo(e+i,n+o-r),t.lineTo(e+i-r,n+o),t.arc(e+i-r,n+o-r,r,0,.5*Math.PI),t.lineTo(e+r,n+o),t.lineTo(e,n+o-r),t.arc(e+r,n+o-r,r,.5*Math.PI,Math.PI),t.lineTo(e,n+r),t.lineTo(e+r,n),t.fill(),t.closePath()},e.prototype.render=function(t){this.constraints&&(t.save(),t.beginPath(),this.renderTranslate(t),this.roundRect(t,0,0,this.constraints.w,this.constraints.h,Math.min(this.constraints.w,this.constraints.h)/2),t.arc(0,0,this.constraints.w,this.constraints.h,2*Math.PI),t.clip(),this.renderSubviews(t),t.restore())},e}(t("../component_view").ComponentView);n.ClipOval=i},{"../component_view":14}],4:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColoredBox=void 0;var i=t("../../components/utils"),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.color=(0,i.cssColor)(e.color)},e.prototype.render=function(t){var e;this.constraints&&(this.renderTranslate(t),t.fillStyle=null!==(e=this.color)&&void 0!==e?e:"transparnet",t.fillRect(0,0,this.constraints.w,this.constraints.h))},e}(t("../component_view").ComponentView);n.ColoredBox=o},{"../../components/utils":57,"../component_view":14}],5:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Image=void 0;var i=function(t){function e(e){var n=t.call(this,e)||this;return n.initialAttributes=e,n.renderElement=document.createElement("img"),n}return __extends(e,t),e.prototype.setAttributes=function(e){var n=this;if(t.prototype.setAttributes.call(this,e),this.src!==e.src&&(this.src=e.src,this.renderElement.src=this.src,this.renderElement.onload=function(){var t;null===(t=n.engine.app.currentPage)||void 0===t||t.setNeedsRender()}),console.log("111111111111111111111"),e.assetName){var i="";i=this.engine.debugger?e.assetPkg?"http://".concat(n.engine.debugger.serverAddr,"/assets/packages/").concat(e.assetPkg,"/").concat(e.assetName):"http://".concat(n.engine.debugger.serverAddr,"/assets/").concat(e.assetName):e.assetPkg?"assets/packages/".concat(e.assetPkg,"/").concat(e.assetName):"assets/".concat(e.assetName),this.src=i,this.renderElement.src=this.src,this.renderElement.onload=function(){var t;null===(t=n.engine.app.currentPage)||void 0===t||t.setNeedsRender()}}},e.prototype.render=function(t){this.constraints&&(t.save(),this.renderTranslate(t),t.drawImage(this.renderElement,0,0,this.constraints.w,this.constraints.h),t.restore())},e}(t("../component_view").ComponentView);n.Image=i},{"../component_view":14}],6:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Offstage=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.offstage=!0,e}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.offstage=e.offstage},e.prototype.render=function(t){this.offstage||(t.save(),this.renderTranslate(t),this.renderSubviews(t),t.restore())},e}(t("../component_view").ComponentView);n.Offstage=i},{"../component_view":14}],7:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Opacity=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.opacity=1,e}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.opacity=e.opacity},e.prototype.render=function(t){t.save(),t.globalAlpha*=this.opacity,this.renderTranslate(t),this.renderSubviews(t),t.restore()},e}(t("../component_view").ComponentView);n.Opacity=i},{"../component_view":14}],8:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WidgetSpan=n.TextSpan=n.RichText=void 0;var i=t("../component_view"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.measuring=!1,e.didSetOnClicked=!1,e.canMeasureResultCache=!1,e.textCache="",e.textCacheSize=0,e}return __extends(e,t),e.prototype.setConstraints=function(t){this.measuring||t&&(this.constraints=t)},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.render=function(t){console.log("444444444444444"),this.constraints&&(t.save(),this.renderTranslate(t),t.restore())},e.prototype.setSingleTextSpan=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n;return __generator(this,(function(i){return e={},t[0].attributes.style,t[0].attributes.text&&(n=t[0].attributes.text,e.letterSpacing||e.wordSpacing||e.height||!1!==/[^㐀-𫠚]/g.test(n)||(this.canMeasureResultCache=!0,this.textCache=n,this.textCacheSize=parseInt(e.fontSize))),[2]}))}))},e.prototype.setChildren=function(e){var n;e&&1===e.length&&"text_span"===e[0].name&&(null===(n=e[0].attributes)||void 0===n?void 0:n.text)?this.setSingleTextSpan(e):t.prototype.setChildren.call(this,e)},e}(i.ComponentView);n.RichText=o;var r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.didSetOnClicked=!1,e.text="",e}return __extends(e,t),e.prototype.setChildren=function(e){e instanceof Array&&e.length>0&&t.prototype.setChildren.call(this,e)},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e);e.style,e.text&&(this.text=e.text),e.onTap_el&&e.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0)},e.prototype.render=function(t){console.log("2222222222222222"),this.constraints&&(t.save(),this.renderTranslate(t),t.fillStyle="rgb(2,100,30)",t.font="48px serif",t.fillText("Hello World",0,0),t.restore())},e}(i.ComponentView);n.TextSpan=r;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setChildren=function(e){t.prototype.setChildren.call(this,e)},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.render=function(t){console.log("33333333333333"),this.constraints&&(t.save(),this.renderTranslate(t),t.restore())},e}(i.ComponentView);n.WidgetSpan=s},{"../component_view":14}],9:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Text=void 0;var i=function(t){function e(e){var n=t.call(this,e)||this;return n.initialAttributes=e,n}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.text!==e.text&&(this.text=e.text),console.log("88888888888888")},e.prototype.render=function(t){this.constraints&&(t.save(),this.renderTranslate(t),t.fillText("nknjknkknl",0,0),t.restore())},e}(t("../component_view").ComponentView);n.Text=i},{"../component_view":14}],10:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Transform=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transformParts=[1,0,0,1,0,0],e}return __extends(e,t),e.prototype.setAttributes=function(e){if(t.prototype.setAttributes.call(this,e),e.transform){var n=e.transform.replace("matrix(","").replace(")","");this.transformParts=n.split(",").map((function(t){return parseFloat(t)})),console.log(this.transformParts)}},e.prototype.render=function(t){t.save(),this.renderTranslate(t),t.transform(this.transformParts[0],this.transformParts[1],this.transformParts[2],this.transformParts[3],this.transformParts[4],this.transformParts[5]),this.renderSubviews(t),t.restore()},e}(t("../component_view").ComponentView);n.Transform=i},{"../component_view":14}],11:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Visibility=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.visible=!0,e}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.visible=e.visible},e.prototype.render=function(t){this.visible&&(t.save(),this.renderTranslate(t),this.renderSubviews(t),t.restore())},e}(t("../component_view").ComponentView);n.Visibility=i},{"../component_view":14}],12:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasPage=void 0;var i=t("./mpkit/scaffold"),o=function(){function t(t,e){var n=this;this.canvasContext=t,this.engine=e,this.viewId=-1,this.requestRoute().then((function(t){var i;n.viewId=t,e.managedViews[n.viewId]=n,e.pageMode=!0,e.unmanagedViewFrameData[n.viewId]&&(e.unmanagedViewFrameData[n.viewId].forEach((function(t){n.didReceivedFrameData(t)})),delete e.unmanagedViewFrameData[n.viewId]),null===(i=n.readyCallback)||void 0===i||i.call(n,void 0)}))}return t.prototype.ready=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return[2,new Promise((function(e){t.readyCallback=e}))]}))}))},t.prototype.requestRoute=function(){var t,e,n;return __awaiter(this,void 0,void 0,(function(){var i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.fetchViewport()];case 1:return i=o.sent(),[2,(null!==(e=null===(t=this.engine.app)||void 0===t?void 0:t.router)&&void 0!==e?e:null===(n=this.engine)||void 0===n?void 0:n.router).requestRoute("/",{},!0,{width:i.width,height:i.height})]}}))}))},t.prototype.fetchViewport=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return[2,{width:375,height:667}]}))}))},t.prototype.didReceivedFrameData=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(n){if(!0!==t.ignoreScaffold){if(!((e=this.engine.canvasComponentFactory.create(t.scaffold))instanceof i.MPScaffold))return[2];this.scaffoldView!==e&&(this.scaffoldView&&(this.scaffoldView.attached=!1,this.scaffoldView.removeFromSuperview()),this.scaffoldView=e,e instanceof i.MPScaffold&&e.delegate)}return this.render(),[2]}))}))},t.prototype.setNeedsRender=function(){var t=this;this.nextRenderTimer||(this.nextRenderTimer=requestAnimationFrame((function(){t.render(),t.nextRenderTimer=void 0})))},t.prototype.render=function(){this.canvasContext.clearRect(0,0,1e3,1e3),this.scaffoldView&&this.scaffoldView.render(this.canvasContext)},t}();n.CanvasPage=o},{"./mpkit/scaffold":15}],13:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasComponentFactory=void 0;var i=t("./basic/clip_oval"),o=t("./basic/colored_box"),r=t("./basic/offstage"),s=t("./basic/opacity"),a=t("./basic/transform"),l=t("./basic/rich_text"),c=t("./basic/text"),u=t("./basic/image"),d=t("./basic/visibility"),h=t("./component_view"),p=t("./mpkit/scaffold"),f=function(){function t(t){this.engine=t,this.cachedView={},this.cachedElement={},this.textMeasureResults=[],this.markedNeedsFlushTextMeasureResult=!1}return t.prototype.create=function(e){if(e){var n=e["^"],i=e.name,o=e.hashCode;if(1==n&&"number"==typeof o)return this.cachedView[o];if(i&&o){n||(this.cachedElement[o]=e);var r=!t.disableCache&&this.cachedView[o];if(r)return e.constraints&&r.setConstraints(e.constraints),e.attributes&&r.setAttributes(e.attributes),e.children&&r.setChildren(this.fetchCachedChildren(e.children)),r;if(document){var s=t.components[i];s||(s=h.ComponentView);var a=new s(e.attributes);return a.factory=this,a.engine=this.engine,a.hashCode=o,e.constraints&&a.setConstraints(e.constraints),e.attributes&&a.setAttributes(e.attributes),e.children&&(t.disableCache?a.setChildren(e.children):a.setChildren(this.fetchCachedChildren(e.children))),t.disableCache||(this.cachedView[o]=a),a}}}},t.prototype.fetchCachedChildren=function(t){var e=this;return t.map((function(t){var n=t["^"],i=t.hashCode;return n&&e.cachedElement[i]?e.cachedElement[i]:t}))},t.prototype.callbackTextMeasureResult=function(t,e){},t.prototype.callbackTextPainterMeasureResult=function(t,e){},t.prototype.flushTextMeasureResult=function(){},t.components={clip_oval:i.ClipOval,colored_box:o.ColoredBox,opacity:s.Opacity,offstage:r.Offstage,visibility:d.Visibility,transform:a.Transform,image:u.Image,rich_text:l.RichText,text_span:l.TextSpan,widget_span:l.WidgetSpan,text:c.Text,mp_scaffold:p.MPScaffold},t.disableCache=!1,t}();n.CanvasComponentFactory=f},{"./basic/clip_oval":3,"./basic/colored_box":4,"./basic/image":5,"./basic/offstage":6,"./basic/opacity":7,"./basic/rich_text":8,"./basic/text":9,"./basic/transform":10,"./basic/visibility":11,"./component_view":14,"./mpkit/scaffold":15}],14:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentView=void 0;var i=function(){function t(t){this.initialAttributes=t,this.classname="",this.subviews=[]}return t.prototype.setConstraints=function(t){t&&(this.constraints=t)},t.prototype.setAttributes=function(t){},t.prototype.setChildren=function(t){var e=this;if(t instanceof Array){var n=t.map((function(t){return e.factory.create(t)})).filter((function(t){return t})),i=!1,o=-1;if(n.length!==this.subviews.length){i=!0;for(var r=0;r<n.length;r++)if(n[r]!==this.subviews[r]){o=r;break}}else{n.every((function(t,n){return t===e.subviews[n]&&t.superview===e}))||(i=!0)}if(i)if(o>0){var s=[];for(r=o;r<this.subviews.length;r++)s.push(this.subviews[r]);s.forEach((function(t){return t.removeFromSuperview()}));for(r=o;r<n.length;r++)this.addSubview(n[r])}else this.removeAllSubviews(),n.forEach((function(t){return e.addSubview(t)}))}},t.prototype.removeAllSubviews=function(){this.subviews.forEach((function(t){t.superview=void 0})),this.subviews=[]},t.prototype.removeFromSuperview=function(){var t;if(this.superview){var e=this.superview.subviews.indexOf(this);e>=0&&(null===(t=this.superview)||void 0===t||t.subviews.splice(e,1))}},t.prototype.addSubview=function(t){t.superview&&t.removeFromSuperview(),this.subviews.push(t),t.superview=this,t.didMoveToWindow()},t.prototype.didMoveToWindow=function(){this.subviews.forEach((function(t){return t.didMoveToWindow()}))},t.prototype.renderTranslate=function(t){!this.constraints||0==this.constraints.x&&0==this.constraints.y||t.translate(this.constraints.x,this.constraints.y)},t.prototype.renderSubviews=function(t){this.subviews.forEach((function(e){e.render(t)}))},t.prototype.render=function(t){t.save(),this.renderTranslate(t),this.renderSubviews(t),t.restore()},t}();n.ComponentView=i},{}],15:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPScaffold=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attached=!1,e}return __extends(e,t),e.prototype.setAppBar=function(t){},e.prototype.setBody=function(t){this.body=t},e.prototype.setBottomBar=function(t,e,n){},e.prototype.setFloatingBody=function(t){},e.prototype.readdSubviews=function(){},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.setBody(e.body?this.factory.create(e.body):void 0)},e.prototype.setDelegate=function(t){this.delegate=t},e.prototype.setChildren=function(){},e.prototype.render=function(t){this.body&&this.body.render(t)},e}(t("../component_view").ComponentView);n.MPScaffold=i},{"../component_view":14}],16:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AbsorbPointer=void 0;var i=t("../component_view"),o=(t("./gesture_detector"),function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.didSetListener=!1,e}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.didSetListener||(this.didSetListener=!0,this.htmlElement.addEventListener("click",(function(t){t.stopPropagation()})))},e}(i.ComponentView));n.AbsorbPointer=o},{"../component_view":42,"./gesture_detector":26}],17:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClipOval=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{borderRadius:"50%",overflow:"hidden"})},e}(i.ComponentView);n.ClipOval=r},{"../component_view":42,"../dom_utils":44}],18:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ClipRRectAncestor=n.ClipRRect=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){var n,i,s,a,l;t.prototype.setAttributes.call(this,e);var c=e.borderRadius?(0,r.cssBorderRadius)(e.borderRadius):{};c.borderRadius?(0,o.setDOMStyle)(this.htmlElement,{borderRadius:null!==(n=c.borderRadius)&&void 0!==n?n:"unset",overflow:"hidden"}):(0,o.setDOMStyle)(this.htmlElement,{borderTopLeftRadius:null!==(i=c.borderTopLeftRadius)&&void 0!==i?i:"unset",borderTopRightRadius:null!==(s=c.borderTopRightRadius)&&void 0!==s?s:"unset",borderBottomLeftRadius:null!==(a=c.borderBottomLeftRadius)&&void 0!==a?a:"unset",borderBottomRightRadius:null!==(l=c.borderBottomRightRadius)&&void 0!==l?l:"unset",overflow:"hidden"})},e}(i.ComponentView);n.ClipRRect=s;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){var n,i,o,s,a;t.prototype.setAttributes.call(this,e),this.target.ancestorStyle.opacity||(this.target.ancestorStyle.opacity=1);var l=e.borderRadius?(0,r.cssBorderRadius)(e.borderRadius):{};l.borderRadius?(this.target.ancestorStyle.borderRadius=null!==(n=l.borderRadius)&&void 0!==n?n:"unset",this.target.ancestorStyle.overflow="hidden"):(this.target.ancestorStyle.borderTopLeftRadius=null!==(i=l.borderTopLeftRadius)&&void 0!==i?i:"unset",this.target.ancestorStyle.borderTopRightRadius=null!==(o=l.borderTopRightRadius)&&void 0!==o?o:"unset",this.target.ancestorStyle.borderBottomLeftRadius=null!==(s=l.borderBottomLeftRadius)&&void 0!==s?s:"unset",this.target.ancestorStyle.borderBottomRightRadius=null!==(a=l.borderBottomRightRadius)&&void 0!==a?a:"unset",this.target.ancestorStyle.overflow="hidden")},e}(i.AncestorView);n.ClipRRectAncestor=a},{"../component_view":42,"../dom_utils":44,"../utils":57}],19:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CollectionViewLayout=n.CollectionView=void 0;var i=t("../../env"),o=t("../component_view"),r=t("../dom_utils"),s=t("../utils"),a=t("./sliver_persistent_header"),l=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.classname="CollectionView",i.wrapperHtmlElement=i.document.createElement("div"),i.appBarPinnedViews=[],i.appBarPersistentHeight=0,i.appBarPinnedPlained=!1,i.enabledRestoration=!1,i.lastScrollX=0,i.lastScrollY=0,i.viewWidth=0,i.viewHeight=0,i.bottomBarHeight=0,i.bottomBarWithSafeArea=!1,i.reverse=!1,i.didAddScrollListener=!1,i.didAddRefreshListener=!1,i.didAddScrollToLowerListener=!1,i.htmlElement.appendChild(i.wrapperHtmlElement),i}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.dispose=function(){var t;this.didAddScrollListener&&(null===(t=i.MPEnv.platformWindow(this.document))||void 0===t||t.removeEventListener("scroll",this.onWindowScrollEvent),this.htmlElement.removeEventListener("scroll",this.onScrollEvent))},e.prototype.onWindowScrollEvent=function(){var t;if((null===(t=i.MPEnv.platformWindow(this.document))||void 0===t?void 0:t.mpCurrentScrollView)===this){var e=i.MPEnv.platformWindow(this.document);e&&(e.scrollX===this.lastScrollX&&e.scrollY===this.lastScrollY||(this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.attributes.onScroll&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScroll",target:this.attributes.onScroll,scrollLeft:e.scrollX,scrollTop:e.scrollY,viewportDimension:e.innerHeight,scrollHeight:this.document.body.scrollHeight}}))))}},e.prototype.addWindowScrollListener=function(){var t;this.didAddScrollListener||(this.didAddScrollListener=!0,null===(t=i.MPEnv.platformWindow(this.document))||void 0===t||t.addEventListener("scroll",this.onWindowScrollEvent.bind(this)))},e.prototype.onScrollEvent=function(){var t,e;this.htmlElement.scrollLeft===this.lastScrollX&&this.htmlElement.scrollTop===this.lastScrollY||(this.lastScrollX=this.htmlElement.scrollLeft,this.lastScrollY=this.htmlElement.scrollTop,this.attributes.onScroll&&this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScroll",target:this.attributes.onScroll,isRoot:this.attributes.isRoot,scrollLeft:this.htmlElement.scrollLeft,scrollTop:this.htmlElement.scrollTop,viewportDimension:null!==(e=null===(t=this.constraints)||void 0===t?void 0:t.h)&&void 0!==e?e:0,scrollHeight:this.htmlElement.scrollHeight}})),this.htmlElement.scrollTop+this.htmlElement.clientHeight>=this.htmlElement.scrollHeight&&this.onScrollToLowerEvent())},e.prototype.addScrollListener=function(){this.didAddScrollListener||(this.didAddScrollListener=!0,this.htmlElement.addEventListener("scroll",this.onScrollEvent.bind(this)))},e.prototype.onRefreshEvent=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){switch(e.label){case 0:return[4,new Promise((function(e){t.refreshEndResolver=e,t.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onRefresh",target:t.hashCode,isRoot:t.attributes.isRoot}}))}))];case 1:return e.sent(),this.htmlElement.setAttribute("refresher-triggered","false"),[2]}}))}))},e.prototype.addRefreshListener=function(){this.didAddRefreshListener||(this.didAddRefreshListener=!0,this.htmlElement.addEventListener("refresherrefresh",this.onRefreshEvent.bind(this)))},e.prototype.onScrollToLowerEvent=function(){this.engine.sendMessage(JSON.stringify({type:"scroll_view",message:{event:"onScrollToLower",target:this.hashCode,isRoot:this.attributes.isRoot}}))},e.prototype.jumpTo=function(t){0},e.prototype.addScrollToLowerListener=function(){this.didAddScrollToLowerListener||(this.didAddScrollToLowerListener=!0,this.htmlElement.addEventListener("scrolltolower",this.onScrollToLowerEvent.bind(this)))},e.prototype.didMoveToWindow=function(){t.prototype.didMoveToWindow.call(this),this.enabledRestoration,this.enabledRestoration},e.prototype.setConstraints=function(e){t.prototype.setConstraints.call(this,e),this.viewWidth===e.w&&this.viewHeight===e.h||(this.viewWidth=e.w,this.viewHeight=e.h,this.reloadLayouts())},e.prototype.reloadLayouts=function(){var t,e,n,i,o,s,l,c;this.layout.prepareLayout();for(var u=this.appBarPinnedPlained?0:-this.appBarPersistentHeight,d=this.appBarPersistentHeight,h=0;h<this.subviews.length;h++){var p=this.subviews[h],f=this.layout.layoutAttributesForItemAtIndex(h);f&&(p.collectionViewConstraints={top:f.y.toFixed(1)+"px",left:f.x.toFixed(1)+"px"},(0,r.setDOMStyle)(p.htmlElement,{position:"absolute",top:f.y.toFixed(1)+"px",left:f.x.toFixed(1)+"px",width:f.width.toFixed(1)+"px",height:f.height.toFixed(1)+"px"}),p instanceof a.SliverPersistentHeader&&p.pinned?(p.y=f.y-u,p.h=d,u+=p.y+(null!==(e=null===(t=p.constraints)||void 0===t?void 0:t.h)&&void 0!==e?e:0),d+=null!==(i=null===(n=p.constraints)||void 0===n?void 0:n.h)&&void 0!==i?i:0,p.updateLayout()):p instanceof a.SliverPersistentHeader&&p.lazying&&(p.y=f.y-u,p.h=d,u+=p.y+(null!==(s=null===(o=p.constraints)||void 0===o?void 0:o.h)&&void 0!==s?s:0),d+=null!==(c=null===(l=p.constraints)||void 0===l?void 0:l.h)&&void 0!==c?c:0,p.updateLayout()))}var v=this.layout.collectionViewContentSize();(0,r.setDOMStyle)(this.wrapperHtmlElement,{position:"absolute",top:"0px",left:"0px",width:v.width+"px",height:this.bottomBarWithSafeArea?"calc(".concat(v.height+("div"===this.elementType()?this.bottomBarHeight:0),"px + env(safe-area-inset-bottom))"):v.height+("div"===this.elementType()?this.bottomBarHeight:0)+"px"})},e.prototype.setAttributes=function(e){var n,o;t.prototype.setAttributes.call(this,e);var s="scroll";if(e.scrollDisabled?s="hidden":e.isRoot&&(s="unset"),(0,r.setDOMStyle)(this.htmlElement,{overflow:s}),this.bottomBarHeight=null!==(n=e.bottomBarHeight)&&void 0!==n?n:0,this.bottomBarWithSafeArea=null!==(o=e.bottomBarWithSafeArea)&&void 0!==o&&o,e.restorationId,e.restorationId,this.htmlElement.setAttribute("scroll-x","Axis.horizontal"===this.attributes.scrollDirection?"true":"false"),this.htmlElement.setAttribute("scroll-y","Axis.horizontal"!==this.attributes.scrollDirection?"true":"false"),this.reverse=e.reverse,(0,r.setDOMStyle)(this.htmlElement,{transform:this.reverse?"Axis.horizontal"===this.attributes.scrollDirection?"scale(-1.0, 1.0)":"scale(1.0, -1.0)":"unset"}),this.updateSubviewTransform(),e.isRoot&&"div"===this.elementType()){var a=i.MPEnv.platformWindow(this.document);a&&(a.mpCurrentScrollView=this),this.addWindowScrollListener()}else this.addScrollListener(),this.addRefreshListener(),this.addScrollToLowerListener(),this.htmlElement.setAttribute("refresher-enabled",e.onRefresh?"true":"false")},e.prototype.addSubview=function(t){(0,r.setDOMStyle)(t.htmlElement,{transform:this.reverse?"Axis.horizontal"===this.attributes.scrollDirection?"scale(-1.0, 1.0)":"scale(1.0, -1.0)":"unset"}),t.superview&&t.removeFromSuperview(),this.subviews.push(t),t.superview=this,this.wrapperHtmlElement.appendChild(t.htmlElement),t.didMoveToWindow()},e.prototype.updateSubviewTransform=function(){var t=this;this.subviews.forEach((function(e){(0,r.setDOMStyle)(e.htmlElement,{transform:t.reverse?"Axis.horizontal"===t.attributes.scrollDirection?"scale(-1.0, 1.0)":"scale(1.0, -1.0)":"unset"})}))},e.prototype.setPinnedAppBar=function(t){var e,n,i=this;if(t.appBarPinnedPlained){var o=this.factory.create(t.appBarPinned,this.document);return this.appBarPersistentHeight=(0,s.cssSizeFromMPElement)(o).height,void(this.appBarPinnedPlained=!0)}this.appBarPinnedPlained=!1;var a=this.factory.create(t.appBarPinned,this.document);if(a){a.collectionViewFixed=!0;var l=null!==(n=null===(e=a.constraints)||void 0===e?void 0:e.h)&&void 0!==n?n:0,c=0,u=1===(null==a?void 0:a.subviews.length)?0:1;null==a||a.subviews.slice().forEach((function(t,e){var n,o,d,h,p,f,v,m;e===u-1&&(c+=null!==(o=null===(n=t.constraints)||void 0===n?void 0:n.h)&&void 0!==o?o:0),e===u?((0,r.setDOMStyle)(t.htmlElement,{marginTop:-(l-c)+"px",top:"0px",position:"sticky",zIndex:"9999",backgroundColor:(null!==(h=null===(d=a.attributes)||void 0===d?void 0:d.color)&&void 0!==h?h:null===(p=a.attributes)||void 0===p?void 0:p.backgroundColor)?(0,s.cssColor)(null!==(v=null===(f=a.attributes)||void 0===f?void 0:f.color)&&void 0!==v?v:null===(m=a.attributes)||void 0===m?void 0:m.backgroundColor):"unset"}),i.appBarPersistentHeight=(0,s.cssSizeFromMPElement)(t).height):(0,r.setDOMStyle)(t.htmlElement,{marginTop:-l+"px"}),i.appBarPinnedViews.push(t)})),this.appBarPinnedViews.reverse().forEach((function(t){return i.addSubviewForPinnedAppBar(t)})),(0,r.setDOMStyle)(a.htmlElement,{pointerEvents:"none",display:"none"})}},e.prototype.addSubviewForPinnedAppBar=function(t){t.superview&&t.removeFromSuperview(),t.superview=this,this.wrapperHtmlElement.firstChild?this.wrapperHtmlElement.insertBefore(t.htmlElement,this.wrapperHtmlElement.firstChild):this.wrapperHtmlElement.appendChild(t.htmlElement),t.didMoveToWindow()},e}(o.ComponentView);n.CollectionView=l;var c=function(){function t(t){this.collectionView=t}return t.prototype.prepareLayout=function(){},t.prototype.layoutAttributesForItemAtIndex=function(t){throw""},t.prototype.collectionViewContentSize=function(){throw""},t}();n.CollectionViewLayout=c},{"../../env":60,"../component_view":42,"../dom_utils":44,"../utils":57,"./sliver_persistent_header":37}],20:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ColoredBox=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:e.color?(0,r.cssColor)(e.color):"unset"})},e}(i.ComponentView);n.ColoredBox=s},{"../component_view":42,"../dom_utils":44,"../utils":57}],21:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CustomPaint=n.MPDrawable=void 0;var i=t("../../env"),o=t("../component_view"),r=t("../dom_utils"),s=t("../utils"),a=function(){function t(t){this.engine=t,this.decodedDrawables={}}return t.prototype.decodeDrawable=function(e){return __awaiter(this,void 0,void 0,(function(){var n,o,r;return __generator(this,(function(s){switch(s.label){case 0:return[3,3];case 1:return n.offscreenCanvas=s.sent(),[3,3];case 2:t.offscreenCanvas=i.MPEnv.platformScope.createOffscreenCanvas(),s.label=3;case 3:return s.trys.push([3,11,,12]),"networkImage"!==e.type?[3,5]:[4,this.decodeNetworkImage(e.url,e.target)];case 4:return o=s.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:e.target,width:o.width,height:o.height}})),[3,10];case 5:return"memoryImage"!==e.type?[3,7]:[4,this.decodeMemoryImage(e.data,e.imageType,e.target)];case 6:return o=s.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:e.target,width:o.width,height:o.height}})),[3,10];case 7:return"assetImage"!==e.type?[3,9]:[4,this.decodeAssetImage(e.assetName,e.assetPkg,e.target)];case 8:return o=s.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onDecode",target:e.target,width:o.width,height:o.height}})),[3,10];case 9:if("dispose"!==e.type)throw new Error("Unknown drawable type.");delete this.decodedDrawables[e.target],s.label=10;case 10:return[3,12];case 11:return r=s.sent(),this.engine.sendMessage(JSON.stringify({type:"decode_drawable",message:{event:"onError",target:e.target,error:null==r?void 0:r.toString()}})),[3,12];case 12:return[2]}}))}))},t.prototype.decodeNetworkImage=function(t,e){return __awaiter(this,void 0,void 0,(function(){var n=this;return __generator(this,(function(i){return[2,new Promise((function(i,o){var r=document.createElement("img");r.onload=function(){n.decodedDrawables[e]=r,i({width:r.width,height:r.height})},r.onerror=function(){o("")},r.src=t}))]}))}))},t.prototype.decodeMemoryImage=function(t,e,n){return __awaiter(this,void 0,void 0,(function(){var i=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){var s=document.createElement("img");s.onload=function(){i.decodedDrawables[n]=s,o({width:s.width,height:s.height})},s.onerror=function(){r("")},s.src="data:image/".concat(null!=e?e:"png",";base64,").concat(t)}))]}))}))},t.prototype.decodeAssetImage=function(t,e,n){return __awaiter(this,void 0,void 0,(function(){var i=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){var s=document.createElement("img");if(s.onload=function(){i.decodedDrawables[n]=s,o({width:s.width,height:s.height})},s.onerror=function(){r("")},i.engine.debugger){var a=e?"http://".concat(i.engine.debugger.serverAddr,"/assets/packages/").concat(e,"/").concat(t):"http://".concat(i.engine.debugger.serverAddr,"/assets/").concat(t);s.src=a}else{a=e?"assets/packages/".concat(e,"/").concat(t):"assets/".concat(t);0,s.src=a}}))]}))}))},t}();n.MPDrawable=a;var l=function(t){function e(e){var n=t.call(this,e)||this;return n.document=e,n.canvasWidth=0,n.canvasHeight=0,n}return __extends(e,t),e.didReceivedCustomPaintMessage=function(t,e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return"fetchImage"===t.event?this.fetchImage(t,e):"asyncPaint"===t.event&&this.asyncPaint(t,e),[2]}))}))},e.fetchImage=function(t,e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){switch(n.label){case 0:return e.componentFactory.cachedView[t.target],[3,1];case 1:return[3,3];case 2:n.sent().fields({node:!0},(function(n){var i=n.node.toDataURL().split("base64,")[1];e.sendMessage(JSON.stringify({type:"custom_paint",message:{event:"onFetchImageResult",seqId:t.seqId,data:i}}))})).exec(),n.label=3;case 3:return[2]}}))}))},e.asyncPaint=function(t,n){return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return(i=n.componentFactory.cachedView[t.target])instanceof e?[4,i.createContext()]:[3,2];case 1:o=r.sent(),t.commands&&i.drawWithCommands(t.commands,o),r.label=2;case 2:return[2]}}))}))},e.prototype.elementType=function(){return"canvas"},e.prototype.setConstraints=function(t){if(t){var e=t.x,n=t.y,i=t.w,o=t.h;"number"==typeof e&&"number"==typeof n&&"number"==typeof i&&"number"==typeof o&&((0,r.setDOMStyle)(this.htmlElement,{left:e+"px",top:n+"px",width:i+"px",height:o+"px"}),this.canvasWidth===i&&this.canvasHeight==o||(this.canvasWidth=i,this.canvasHeight=o))}},e.prototype.createContext=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return[2,this.htmlElement.getContext("2d")]}))}))},e.prototype.drawWithCommands=function(t,e){var n=this;e.save(),t.forEach((function(t){"drawRect"===t.action?n.drawRect(e,t):"drawPath"===t.action?n.drawPath(e,t):"drawDRRect"===t.action?n.drawDRRect(e,t):"clipPath"===t.action?n.drawPath(e,t):"drawColor"===t.action?n.drawColor(e,t):"drawImage"===t.action?n.drawImage(e,t):"drawImageRect"===t.action?n.drawImageRect(e,t):"drawText"===t.action?n.drawText(e,t):"restore"===t.action?e.restore():"rotate"===t.action?e.rotate(t.radians):"save"===t.action?e.save():"scale"===t.action?e.scale(t.sx,t.sy):"skew"===t.action?e.transform(1,t.sy,t.sx,1,0,0):"transform"===t.action?e.transform(t.a,t.b,t.c,t.d,t.tx,t.ty):"translate"===t.action&&e.translate(t.dx,t.dy)})),e.restore()},e.prototype.setAttributes=function(e){var n;return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return t.prototype.setAttributes.call(this,e),null===(n=this.ctx)||void 0===n?[3,1]:(o=n,[3,3]);case 1:return[4,this.createContext()];case 2:o=r.sent(),r.label=3;case 3:return(i=o)?(this.ctx||(this.ctx=i),e.commands&&this.drawWithCommands(e.commands,i),[2]):[2]}}))}))},e.prototype.drawRect=function(t,e){this.setPaint(t,e.paint),"PaintingStyle.fill"===e.paint.style?t.fillRect(e.x,e.y,e.width,e.height):t.strokeRect(e.x,e.y,e.width,e.height)},e.prototype.drawPath=function(t,e){this.setPaint(t,e.paint),this.drawRealPath(t,e.path),"clipPath"===e.action?t.clip():"PaintingStyle.fill"===e.paint.style?t.fill():t.stroke()},e.prototype.drawDRRect=function(t,e){var n=document.createElement("canvas");n.width=t.canvas.width,n.height=t.canvas.height;var i=n.getContext("2d");this.setPaint(i,e.paint),this.drawRealPath(i,e.outer),"PaintingStyle.fill"===e.paint.style?i.fill():i.stroke(),i.save(),i.fillStyle="white",i.globalCompositeOperation="xor",this.drawRealPath(i,e.inner),i.fill(),i.restore(),t.drawImage(n,0,0)},e.prototype.drawRealPath=function(t,e){t.beginPath(),e.commands.forEach((function(e){"moveTo"===e.action?t.moveTo(e.x,e.y):"lineTo"===e.action?t.lineTo(e.x,e.y):"quadraticBezierTo"===e.action?t.quadraticCurveTo(e.x1,e.y1,e.x2,e.y2):"cubicTo"===e.action?t.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x3,e.y3):"arcTo"===e.action?t.ellipse(e.x,e.y,e.width/2,e.height/2,0,e.startAngle,e.startAngle+e.sweepAngle,e.sweepAngle<0):"arcToPoint"===e.action?t.arcTo(e.arcControlX,e.arcControlY,e.arcEndX,e.arcEndY,e.radiusX):"close"===e.action&&t.closePath()}))},e.prototype.drawColor=function(t,e){"BlendMode.clear"===e.blendMode?t.clearRect(0,0,t.canvas.width,t.canvas.height):(t.fillStyle=(0,s.cssColor)(e.color),t.fillRect(0,0,t.canvas.width,t.canvas.height))},e.prototype.drawImage=function(t,e){this.setPaint(t,e.paint);var n=this.engine.drawable.decodedDrawables[e.drawable];n&&t.drawImage(n,e.dx,e.dy)},e.prototype.drawImageRect=function(t,e){this.setPaint(t,e.paint);var n=this.engine.drawable.decodedDrawables[e.drawable];n&&t.drawImage(n,e.srcX,e.srcY,e.srcW,e.srcH,e.dstX,e.dstY,e.dstW,e.dstH)},e.prototype.drawText=function(t,e){var n=e.text,i=e.style,o=e.offset;this.setTextStyle(t,i),this.setPaint(t,e.paint),"PaintingStyle.fill"===e.paint.style?t.fillText(n,o.x,o.y):t.strokeText(n,o.x,o.y)},e.prototype.setTextStyle=function(t,e){var n,i,o,r="".concat((null!==(n=e.fontSize)&&void 0!==n?n:14).toString(),"px ").concat(null!==(i=e.fontFamily)&&void 0!==i?i:"system-ui"),a=(0,s.getFontWeightStyle)(e);a&&(r=a+" "+r);var l=(0,s.getFontStyleStyle)(e);l&&(r=l+" "+r),t.font=r,t.textBaseline=null!==(o=(0,s.getBaselineStyle)(e))&&void 0!==o?o:"middle"},e.prototype.setPaint=function(t,e){var n;e&&(t.lineWidth=e.strokeWidth,t.miterLimit=e.strokeMiterLimit,t.lineCap=e.strokeCap.replace("StrokeCap.",""),t.lineJoin=e.strokeJoin.replace("StrokeJoin.",""),"PaintingStyle.fill"===e.style?(e.gradient?t.fillStyle=this.createGradient(t,e.gradient):t.fillStyle=(0,s.cssColor)(e.color),t.strokeStyle="transparent"):(t.fillStyle="transparent",e.gradient?t.strokeStyle=this.createGradient(t,e.gradient):t.strokeStyle=(0,s.cssColor)(e.color)),t.globalAlpha=null!==(n=e.alpha)&&void 0!==n?n:1)},e.prototype.createGradient=function(t,e){if("LinearGradient"===e.classname){var n=t.createLinearGradient(e.fromX,e.fromY,e.toX,e.toY);if(e.stops&&e.stops.length)e.colors.forEach((function(t,i){void 0!==e.stops[i]&&n.addColorStop(e.stops[i],(0,s.cssColor)(t))}));else{var i=1/(e.colors.length-1);e.colors.forEach((function(t,o){void 0!==e.stops[o]&&n.addColorStop(o*i,(0,s.cssColor)(t))}))}return n}},e}(o.ComponentView);n.CustomPaint=l},{"../../env":60,"../component_view":42,"../dom_utils":44,"../utils":57}],22:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.CustomScrollView=void 0;var i=t("../utils"),o=t("./collection_view"),r=t("./grid_list_layout"),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.listChildren=[],i.layout=new a(i),i}return __extends(e,t),e.prototype.setChildren=function(e){var n=this;if(e){var i=[],o={},r={};e.forEach((function(t,e){var s,a,l,c,u,d,h,p;"sliver_list"===t.name&&t.children?(o[i.length]=t.attributes,n.factory.fetchCachedChildren(t.children).forEach((function(t){i.push(t)})),r[i.length-1]=!0):"sliver_list"===(null===(a=null===(s=t.children)||void 0===s?void 0:s[0])||void 0===a?void 0:a.name)&&(null===(c=null===(l=t.children)||void 0===l?void 0:l[0])||void 0===c?void 0:c.children)?(o[i.length]=t.children[0].attributes,n.factory.fetchCachedChildren(t.children[0].children).forEach((function(t,e){i.push(t)})),r[i.length-1]=!0):"sliver_grid"===t.name&&t.children?(o[i.length]=t.attributes,n.factory.fetchCachedChildren(t.children).forEach((function(t){i.push(t)})),r[i.length-1]=!0):"sliver_grid"===(null===(d=null===(u=t.children)||void 0===u?void 0:u[0])||void 0===d?void 0:d.name)&&(null===(p=null===(h=t.children)||void 0===h?void 0:h[0])||void 0===p?void 0:p.children)?(o[i.length]=t.children[0].attributes,n.factory.fetchCachedChildren(t.children[0].children).forEach((function(t){i.push(t)})),r[i.length-1]=!0):i.push(t)})),this.listChildren=i,this.layout.items=i,this.layout.sliverGridAttributes=o,this.layout.sliverGridEndIndex=r,t.prototype.setChildren.call(this,i),this.reloadLayouts()}},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.layout.isHorizontalScroll="Axis.horizontal"===e.scrollDirection,e.appBarPinned?this.setPinnedAppBar(e):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(t){return t.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0)},e}(o.CollectionView);n.CustomScrollView=s;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHorizontalScroll=!1,e.items=[],e.maxVLength=0,e.itemLayouts=[],e.sliverGridAttributes={},e.sliverGridEndIndex={},e}return __extends(e,t),e.prototype.prepareLayout=function(){var t=this,e=this.collectionView.viewWidth,n=this.collectionView.viewHeight;if(!(this.isHorizontalScroll&&n<=.01)&&(this.isHorizontalScroll||!(e<=.01))){var o,s=[],a=0,l=0;this.items.forEach((function(c,u){var d,h,p,f;if(t.sliverGridAttributes[u]){l=0,(o=new r.GridListLayout(t.collectionView)).isHorizontalScroll=t.isHorizontalScroll;for(var v=[],m=u;m<t.items.length&&(v.push(t.items[m]),!t.sliverGridEndIndex[m]);m++);o.clientWidth=t.collectionView.viewWidth,o.clientHeight=t.collectionView.viewHeight;var g=t.sliverGridAttributes[u].gridDelegate;if(g&&(o.isPlain="SliverWaterfallDelegate"!==g.classname,o.crossAxisCount=g.crossAxisCount,o.mainAxisSpacing=g.mainAxisSpacing,o.crossAxisSpacing=g.crossAxisSpacing),t.sliverGridAttributes[u].padding){var y=(0,i.cssPadding)(t.sliverGridAttributes[u].padding);o.padding.top=parseFloat(null!==(d=y.paddingTop)&&void 0!==d?d:"0.0"),o.padding.left=parseFloat(null!==(h=y.paddingLeft)&&void 0!==h?h:"0.0"),o.padding.bottom=parseFloat(null!==(p=y.paddingBottom)&&void 0!==p?p:"0.0"),o.padding.right=parseFloat(null!==(f=y.paddingRight)&&void 0!==f?f:"0.0")}o.items=v,o.prepareLayout()}if(o){if(l<o.itemLayouts.length){var b=__assign({},o.itemLayouts[l]);t.isHorizontalScroll?b.x+=a:b.y+=a,s.push(b)}else s.push({x:0,y:0,width:0,height:0});l++}if(t.sliverGridEndIndex[u]&&o)return t.isHorizontalScroll?a+=o.collectionViewContentSize().width:a+=o.collectionViewContentSize().height,t.maxVLength=a,void(o=void 0);if(!o){var w,_=(0,i.cssSizeFromMPElement)(c);t.isHorizontalScroll?(w={x:a,y:0,width:_.width,height:n},a+=_.width):(w={x:0,y:a,width:e,height:_.height},"sliver_persistent_header"===c.name&&c.attributes.lazying||(a+=_.height)),t.maxVLength=a,s.push(w)}})),this.itemLayouts=s}},e.prototype.collectionViewContentSize=function(){return this.isHorizontalScroll?{width:this.maxVLength,height:this.collectionView.viewHeight}:{width:this.collectionView.viewWidth,height:this.maxVLength}},e.prototype.layoutAttributesForItemAtIndex=function(t){return this.itemLayouts[t]},e}(o.CollectionViewLayout)},{"../utils":57,"./collection_view":19,"./grid_list_layout":27}],23:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DecoratedBox=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e,n,i){var s,a,l,c,u,d,h,p,f,v=this;void 0===n&&(n={}),void 0===i&&(i=this.htmlElement),t.prototype.setAttributes.call(this,e);var m=null!=n?n:{};if(e.color?m.backgroundColor=(0,r.cssColor)(e.color):e.image?(m.backgroundImage='url("'.concat(e.image.src?e.image.src:e.image.assetName?v.engine.debugger?e.image.assetPkg?"http://".concat(v.engine.debugger.serverAddr,"/assets/packages/").concat(e.image.assetPkg,"/").concat(e.image.assetName):"http://".concat(v.engine.debugger.serverAddr,"/assets/").concat(e.image.assetName):e.image.assetPkg?"assets/packages/".concat(e.image.assetPkg,"/").concat(e.assetName):"assets/".concat(e.image.assetName):void 0,'")'),"BoxFit.cover"===e.image.fit?m.backgroundSize="cover":m.backgroundSize="contain",m.backgroundRepeat="no-repeat"):(null===(s=e.decoration)||void 0===s?void 0:s.gradient)?m.backgroundImage?m.backgroundImage=(0,r.cssGradient)(e.decoration.gradient)+","+m.backgroundImage:m.background=(0,r.cssGradient)(e.decoration.gradient):(m.backgroundImage="unset",m.background="unset"),null===(l=null===(a=e.decoration)||void 0===a?void 0:a.boxShadow)||void 0===l?void 0:l[0]){var g=null===(u=null===(c=e.decoration)||void 0===c?void 0:c.boxShadow)||void 0===u?void 0:u[0];m.boxShadow="".concat(null===(d=(0,r.cssOffset)(g.offset))||void 0===d?void 0:d.dx,"px ").concat(null===(h=(0,r.cssOffset)(g.offset))||void 0===h?void 0:h.dy,"px ").concat(g.blurRadius,"px ").concat(g.spreadRadius,"px ").concat((0,r.cssColor)(g.color))}if(null===(p=e.decoration)||void 0===p?void 0:p.borderRadius){var y=(0,r.cssBorderRadius)(e.decoration.borderRadius);for(var b in y)m[b]=y[b]}else m.borderRadius="0px";if(null===(f=e.decoration)||void 0===f?void 0:f.border){y=(0,r.cssBorder)(e.decoration.border);for(var b in y.boxSizing="border-box",y)m[b]=y[b]}else m.border="none";(0,o.setDOMStyle)(i,m)},e}(i.ComponentView);n.DecoratedBox=s},{"../component_view":42,"../dom_utils":44,"../utils":57}],24:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.EditableText=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentElementType="",e.didSetListener=!1,e}return __extends(e,t),e.prototype.setAttributes=function(e){var n,i,s=this;t.prototype.setAttributes.call(this,e);var a=e.maxLines;if(a>1&&"textarea"!==this.contentElementType?(null===(n=this.contentElement)||void 0===n||n.remove(),this.contentElement=this.document.createElement("textarea"),this.didSetListener=!1,this.contentElementType="textarea",(0,o.setDOMStyle)(this.contentElement,{width:"100%",height:"100%",backgroundColor:"transparent",border:"none",resize:"none"}),this.htmlElement.appendChild(this.contentElement)):a<=1&&"input"!==this.contentElementType&&(null===(i=this.contentElement)||void 0===i||i.remove(),this.contentElement=this.document.createElement("input"),this.didSetListener=!1,this.contentElementType="input",(0,o.setDOMStyle)(this.contentElement,{width:"100%",height:"100%",backgroundColor:"transparent",border:"none"}),this.htmlElement.appendChild(this.contentElement)),this.contentElement){if(e.placeholderStyle){var l="";e.placeholderStyle.color&&(l+="color: ".concat((0,r.cssColor)(e.placeholderStyle.color),";")),(0,o.setDOMAttribute)(this.contentElement,"placeholder-style",l)}if(this.contentElement.onkeyup=function(t){"Enter"!==t.key&&13!==t.keyCode||s._onSubmitted(t.target,t.target.value)},this.didSetListener||(this.didSetListener=!0,this.contentElement.addEventListener("submit",(function(t){var e,n;s._onSubmitted(t.target,null!==(n=null===(e=t.detail)||void 0===e?void 0:e.value)&&void 0!==n?n:t.target.value)})),this.contentElement.addEventListener("confirm",(function(t){var e,n;s._onSubmitted(t.target,null!==(n=null===(e=t.detail)||void 0===e?void 0:e.value)&&void 0!==n?n:t.target.value)})),this.contentElement.addEventListener("input",(function(t){var e,n;s._onChanged(t.target,null!==(n=null===(e=t.detail)||void 0===e?void 0:e.value)&&void 0!==n?n:t.target.value)})),this.contentElement.addEventListener("focus",(function(){s.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onFocus",target:s.hashCode}}))})),this.contentElement.addEventListener("blur",(function(){s.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onBlur",target:s.hashCode}}))}))),this.contentElement.onchange=function(t){var e,n;s._onChanged(t.target,null!==(n=null===(e=t.detail)||void 0===e?void 0:e.value)&&void 0!==n?n:t.target.value)},e.style){var c=(0,r.cssTextStyle)(e.style);delete c.userSelect,delete c.WebkitUserSelect,(0,o.setDOMStyle)(this.contentElement,__assign(__assign({},c),{textAlign:(0,r.cssTextAlign)(e.textAlign),boxSizing:"border-box"}))}(0,o.setDOMAttribute)(this.contentElement,"type",e.obscureText?"password":this._keyboardType(e.keyboardType));this._keyboardPattern(e.keyboardType);0,"string"==typeof e.value&&(this.contentElement.value=e.value),e.autofocus&&(0,o.setDOMAttribute)(this.contentElement,"auto-focus",e.autofocus),e.autoCorrect&&(0,o.setDOMAttribute)(this.contentElement,"auto-correct",e.autoCorrect),e.placeholder&&(0,o.setDOMAttribute)(this.contentElement,"placeholder",e.placeholder),e.maxLength&&(0,o.setDOMAttribute)(this.contentElement,"maxlength",e.maxLength),(0,o.setDOMAttribute)(this.contentElement,"read-only",e.readOnly?"true":void 0)}},e.prototype.setChildren=function(){},e.prototype._keyboardType=function(t){return(null==t?void 0:t.indexOf("TextInputType.number"))>=0?"number":"text"},e.prototype._keyboardPattern=function(t){if((null==t?void 0:t.indexOf("TextInputType.number"))>=0){var e=t.indexOf("signed: true")>=0,n=t.indexOf("decimal: true")>=0;if(e&&n)return"[0-9+-.]*";if(e&&!n)return"[0-9+-]*";if(!e&&!n)return"[0-9]*";if(!e&&n)return"[0-9+.]*"}return""},e.prototype._textInputAction=function(t){return t.replace("TextInputAction.","")},e.prototype._onSubmitted=function(t,e){this.attributes.onSubmitted&&(this.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onSubmitted",target:this.attributes.onSubmitted,data:e}})),t.blur())},e.prototype._onChanged=function(t,e){this.attributes.onChanged&&this.engine.sendMessage(JSON.stringify({type:"editable_text",message:{event:"onChanged",target:this.attributes.onChanged,data:e}}))},e}(i.ComponentView);n.EditableText=s},{"../component_view":42,"../dom_utils":44,"../utils":57}],25:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ForegroundDecoratedBox=void 0;var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.decorateElement=e.document.createElement("div"),e}return __extends(e,t),e.prototype.setChildren=function(e){t.prototype.setChildren.call(this,e),this.decorateElement.remove(),this.htmlElement.appendChild(this.decorateElement)},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e,{position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%"},this.decorateElement)},e}(t("./decorated_box").DecoratedBox);n.ForegroundDecoratedBox=i},{"./decorated_box":23}],26:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GestureDetector=void 0;var i=t("../../env"),o=function(t){function e(e){var n=t.call(this,e)||this;return n.document=e,n.classname="GestureDetector",n.didSetOnClicked=!1,n.didSetOnLongPressOrPan=!1,n.longPressing=!1,n.htmlElement.isGestureDetector=!0,n.setupCursor(),n}return __extends(e,t),e.prototype.setupCursor=function(){i.MPEnv.platformPC()&&(this.htmlElement.style.cursor="pointer")},e.prototype.elementType=function(){return"div"},e.prototype.setAttributes=function(e){var n=this;t.prototype.setAttributes.call(this,e),e.onTap&&(this.didSetOnClicked||(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(t){n.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onTap",target:e.onTap}})),t.stopPropagation()})))),(e.onLongPress||e.onLongPressStart||e.onLongPressMoveUpdate||e.onLongPressEnd||e.onPanStart||e.onPanUpdate||e.onPanEnd)&&(this.didSetOnLongPressOrPan||(this.didSetOnLongPressOrPan=!0,this.setupLongPressOrPanCatcher()))},e.prototype.findGestureDetectorElement=function(t){for(var e=0;e<t.length;e++){var n=t[e];if(n.isGestureDetector)return n}},e.prototype.setupLongPressOrPanCatcher=function(){var t=this;this.htmlElement.addEventListener("touchstart",(function(e){t._onTouchStart(e)}),!0),this.htmlElement.addEventListener("touchmove",(function(e){t._onTouchMove(e)}),!0),this.htmlElement.addEventListener("touchend",(function(e){t._onTouchEnd(e)}),!0),this.htmlElement.addEventListener("touchcancel",(function(e){t.longPressTimer&&(clearTimeout(t.longPressTimer),t.longPressTimer=void 0),t.longPressing=!1}),!0)},e.prototype._onTouchStart=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n,i,o=this;return __generator(this,(function(r){switch(r.label){case 0:return[3,2];case 1:return n=r.sent(),[3,3];case 2:n=this.htmlElement.getBoundingClientRect(),r.label=3;case 3:return e=n,this.targetOriginInPage={x:e.left,y:e.top},i=this.attributes.onPanStart||this.attributes.onPanUpdate||this.attributes.onPanEnd,(this.attributes.onLongPress||this.attributes.onLongPressStart||this.attributes.onLongPressEnd||this.attributes.onLongPressMoveUpdate||i)&&(this.touchStartPosition={x:t.touches[0].clientX,y:t.touches[0].clientY},this.longPressTimer=setTimeout((function(){o.longPressTimer&&(o.longPressing=!0,o.attributes.onLongPress&&o.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:"onLongPress",target:o.attributes.onLongPress}})),(o.attributes.onLongPressStart||o.attributes.onPanStart)&&o.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:o.attributes.onPanStart?"onPanStart":"onLongPressStart",target:o.attributes.onPanStart?o.attributes.onPanStart:o.attributes.onLongPressStart,globalX:t.touches[0].clientX,globalY:t.touches[0].clientY,localX:t.touches[0].clientX-o.targetOriginInPage.x,localY:t.touches[0].clientY-o.targetOriginInPage.y}})),o.longPressTimer=void 0)}),i?0:300),i&&t.preventDefault()),[2]}}))}))},e.prototype._onTouchMove=function(t){if(this.longPressing&&(this.attributes.onLongPressMoveUpdate||this.attributes.onPanUpdate))this.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:this.attributes.onPanUpdate?"onPanUpdate":"onLongPressMoveUpdate",target:this.attributes.onPanUpdate?this.attributes.onPanUpdate:this.attributes.onLongPressMoveUpdate,globalX:t.touches[0].clientX,globalY:t.touches[0].clientY,localX:t.touches[0].clientX-this.targetOriginInPage.x,localY:t.touches[0].clientY-this.targetOriginInPage.y}})),t.preventDefault();else if(this.longPressTimer&&this.touchStartPosition){var e={x:t.touches[0].clientX,y:t.touches[0].clientY},n=Math.abs(e.x-this.touchStartPosition.x),i=Math.abs(e.y-this.touchStartPosition.y);(n>8||i>8)&&(clearTimeout(this.longPressTimer),this.longPressTimer=void 0)}},e.prototype._onTouchEnd=function(t){this.longPressing&&(this.attributes.onLongPressEnd||this.attributes.onPanEnd)?(this.engine.sendMessage(JSON.stringify({type:"gesture_detector",message:{event:this.attributes.onPanEnd?"onPanEnd":"onLongPressEnd",target:this.attributes.onPanEnd?this.attributes.onPanEnd:this.attributes.onLongPressEnd}})),t.preventDefault()):this.longPressTimer&&(clearTimeout(this.longPressTimer),this.longPressTimer=void 0),this.longPressing=!1},e}(t("../component_view").ComponentView);n.GestureDetector=o},{"../../env":60,"../component_view":42}],27:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GridListLayout=void 0;var i=t("../utils"),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isPlain=!0,e.isHorizontalScroll=!1,e.padding={top:0,left:0,bottom:0,right:0},e.clientWidth=0,e.clientHeight=0,e.crossAxisCount=0,e.crossAxisSpacing=0,e.mainAxisSpacing=0,e.items=[],e.maxVLength=0,e.itemLayouts=[],e}return __extends(e,t),e.prototype.prepareLayout=function(){this.isPlain?this.preparePlainLayout():this.prepareWaterfallLayout()},e.prototype.preparePlainLayout=function(){var t=this,e=(this.clientWidth>0?this.clientWidth:this.collectionView.viewWidth)-this.padding.right,n=(this.clientHeight>0?this.clientHeight:this.collectionView.viewHeight)-this.padding.bottom,o=[],r=this.padding.left,s=this.padding.top,a=0;this.items.forEach((function(l,c){var u=(0,i.cssSizeFromMPElement)(l),d=u.width,h=u.height;if(t.isHorizontalScroll){var p={x:r,y:s,width:d,height:h};s+=h+t.crossAxisSpacing,a=Math.max(r+d,a),s+h-n>.1&&(s=t.padding.top,c+1<t.items.length&&(r+=d+t.mainAxisSpacing)),o.push(p)}else{p={x:r,y:s,width:d,height:h};r+=d+t.crossAxisSpacing,a=Math.max(s+h,a),r+d-e>.1&&(r=t.padding.left,c+1<t.items.length&&(s+=h+t.mainAxisSpacing)),o.push(p)}})),this.isHorizontalScroll?a+=this.padding.right:a+=this.padding.bottom,this.itemLayouts=o,this.maxVLength=a},e.prototype.prepareWaterfallLayout=function(){var t=this;if(this.crossAxisCount<=0)this.itemLayouts=[];else{var e=0,n={},o=[],r=0;this.items.forEach((function(s,a){var l=(0,i.cssSizeFromMPElement)(s),c=l.width,u=l.height,d=t.isHorizontalScroll?t.padding.left:t.padding.top,h=e,p=h+1>=t.crossAxisCount?0:h+1;if(n[h]&&n[p]){var f=n[h],v=n[p];e=t.isHorizontalScroll?v.x+v.width<f.x+f.width?p:h:v.y+v.height<f.y+f.height?p:h}else e=h;if(n[e]){f=n[e];t.isHorizontalScroll?(d=f.x+f.width,a>=t.crossAxisCount&&(d+=t.mainAxisSpacing)):(d=f.y+f.height,a>=t.crossAxisCount&&(d+=t.mainAxisSpacing))}else d=t.isHorizontalScroll?t.padding.left:t.padding.top;if(t.isHorizontalScroll){var m={x:d,y:t.padding.top+u*e+e*t.crossAxisSpacing,width:c,height:u};n[e]=m,e=(e+1)%t.crossAxisCount,r=Math.max(d+c,r),o.push(m)}else{m={x:t.padding.left+c*e+e*t.crossAxisSpacing,y:d,width:c,height:u};n[e]=m,e=(e+1)%t.crossAxisCount,r=Math.max(d+u,r),o.push(m)}})),this.isHorizontalScroll?r+=this.padding.right:r+=this.padding.bottom,this.itemLayouts=o,this.maxVLength=r}},e.prototype.collectionViewContentSize=function(){return this.isHorizontalScroll?{width:this.maxVLength,height:this.collectionView.viewHeight-this.padding.top-this.padding.bottom}:{width:this.collectionView.viewWidth-this.padding.left-this.padding.right,height:this.maxVLength}},e.prototype.layoutAttributesForItemAtIndex=function(t){return this.itemLayouts[t]},e}(t("./collection_view").CollectionViewLayout);n.GridListLayout=o},{"../utils":57,"./collection_view":19}],28:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.GridView=void 0;var i=t("../utils"),o=t("./collection_view"),r=t("./grid_list_layout"),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.listChildren=[],i.layout=new r.GridListLayout(i),i}return __extends(e,t),e.prototype.setChildren=function(e){var n=this;if(t.prototype.setChildren.call(this,e),e){var i=[];this.factory.fetchCachedChildren(e).forEach((function(t){i.push(t),n.factory.create(t,n.document)})),this.layout.items=i,this.listChildren=i,this.reloadLayouts()}},e.prototype.setAttributes=function(e){var n,o,r,s;t.prototype.setAttributes.call(this,e),this.layout.isHorizontalScroll="Axis.horizontal"===e.scrollDirection;var a=e.gridDelegate;if(a&&(this.layout.isPlain="SliverWaterfallDelegate"!==a.classname,this.layout.crossAxisCount=a.crossAxisCount,this.layout.mainAxisSpacing=a.mainAxisSpacing,this.layout.crossAxisSpacing=a.crossAxisSpacing),e.padding){var l=(0,i.cssPadding)(this.attributes.padding);this.layout.padding.top=parseFloat(null!==(n=l.paddingTop)&&void 0!==n?n:"0.0"),this.layout.padding.left=parseFloat(null!==(o=l.paddingLeft)&&void 0!==o?o:"0.0"),this.layout.padding.bottom=parseFloat(null!==(r=l.paddingBottom)&&void 0!==r?r:"0.0"),this.layout.padding.right=parseFloat(null!==(s=l.paddingRight)&&void 0!==s?s:"0.0")}e.appBarPinned?this.setPinnedAppBar(e):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(t){return t.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0),this.reloadLayouts()},e}(o.CollectionView);n.GridView=s},{"../utils":57,"./collection_view":19,"./grid_list_layout":27}],29:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.IgnorePointer=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{pointerEvents:e.ignoring?"none":"unset"})},e}(i.ComponentView);n.IgnorePointer=r},{"../component_view":42,"../dom_utils":44}],30:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Image=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.elementType=function(){return"img"},e.prototype.updateLayout=function(){var e,n,i,r,s,a;(null===(e=this.attributes)||void 0===e?void 0:e.width)&&(null===(n=this.attributes)||void 0===n?void 0:n.height)||(null===(i=this.constraints)||void 0===i?void 0:i.w)&&(null===(r=this.constraints)||void 0===r?void 0:r.h)?t.prototype.updateLayout.call(this):(0,o.setDOMStyle)(this.htmlElement,{position:null!==(a=null===(s=this.additionalConstraints)||void 0===s?void 0:s.position)&&void 0!==a?a:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"})},e.prototype.setAttributes=function(e){var n,i=this;if(t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{objectFit:function(){if(!e.fit)return"cover";switch(e.fit){case"BoxFit.fill":return"fill";case"BoxFit.contain":default:return"contain";case"BoxFit.cover":return"cover";case"BoxFit.fitWidth":case"BoxFit.fitHeight":return"scale-down";case"BoxFit.none":return"none"}}()}),e.fit,e.src)e.lazyLoad,(0,o.setDOMAttribute)(this.htmlElement,"src",e.src);else if(e.base64)(0,o.setDOMAttribute)(this.htmlElement,"src","data:image/".concat(null!==(n=e.imageType)&&void 0!==n?n:"png",";base64,").concat(e.base64));else if(e.assetName)if(this.engine.debugger){var r=e.assetPkg?"http://".concat(i.engine.debugger.serverAddr,"/assets/packages/").concat(e.assetPkg,"/").concat(e.assetName):"http://".concat(i.engine.debugger.serverAddr,"/assets/").concat(e.assetName);(0,o.setDOMAttribute)(this.htmlElement,"src",r)}else{r=e.assetPkg?"assets/packages/".concat(e.assetPkg,"/").concat(e.assetName):"assets/".concat(e.assetName);0,(0,o.setDOMAttribute)(this.htmlElement,"src",r)}this.updateLayout()},e}(i.ComponentView);n.Image=r},{"../component_view":42,"../dom_utils":44}],31:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ListView=void 0;var i=t("../utils"),o=t("./collection_view"),r=t("./grid_list_layout"),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.listChildren=[],i.layout=new r.GridListLayout(i),i}return __extends(e,t),e.prototype.setChildren=function(e){var n=this;if(t.prototype.setChildren.call(this,e),e){var i=[];this.factory.fetchCachedChildren(e).forEach((function(t){i.push(t),n.factory.create(t,n.document)})),this.layout.items=i,this.listChildren=i,this.reloadLayouts()}},e.prototype.setAttributes=function(e){var n,o,r,s;if(t.prototype.setAttributes.call(this,e),this.layout.isHorizontalScroll="Axis.horizontal"===e.scrollDirection,e.padding){var a=(0,i.cssPadding)(this.attributes.padding);this.layout.padding.top=parseFloat(null!==(n=a.paddingTop)&&void 0!==n?n:"0.0"),this.layout.padding.left=parseFloat(null!==(o=a.paddingLeft)&&void 0!==o?o:"0.0"),this.layout.padding.bottom=parseFloat(null!==(r=a.paddingBottom)&&void 0!==r?r:"0.0"),this.layout.padding.right=parseFloat(null!==(s=a.paddingRight)&&void 0!==s?s:"0.0")}e.appBarPinned?this.setPinnedAppBar(e):this.appBarPinnedViews.length&&(this.appBarPinnedViews.forEach((function(t){return t.removeFromSuperview()})),this.appBarPinnedViews=[],this.appBarPersistentHeight=0),this.reloadLayouts()},e}(o.CollectionView);n.ListView=s},{"../utils":57,"./collection_view":19,"./grid_list_layout":27}],32:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MouseRegion=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventListened=!1,e}return __extends(e,t),e.prototype.setAttributes=function(e){var n=this;t.prototype.setAttributes.call(this,e),this.eventListened||(this.eventListened=!0,this.htmlElement.addEventListener("mouseenter",(function(){n.engine.sendMessage(JSON.stringify({type:"mouse_region",message:{event:"onEnter",target:n.hashCode}}))})),this.htmlElement.addEventListener("mouseleave",(function(){n.engine.sendMessage(JSON.stringify({type:"mouse_region",message:{event:"onExit",target:n.hashCode}}))}))),(0,o.setDOMStyle)(this.htmlElement,{cursor:this.cursor(e.cursor)})},e.prototype.cursor=function(t){switch(t.replace("SystemMouseCursor","")){case"(click)":return"pointer";case"(none)":return"none";case"(basic)":return"default";case"(wait)":return"wait";case"(progress)":return"progress";case"(contextMenu)":return"context-menu";case"(help)":return"help";case"(text)":return"text";case"(verticalText)":return"vertical-text";case"(cell)":return"cell";case"(precise)":return"crosshair";case"(move)":return"move";case"(grab)":return"grab";case"(grabbing)":return"grabbing";case"(noDrop)":return"no-drop";case"(alias)":return"alias";case"(copy)":return"copy";case"(allScroll)":return"all-scroll";case"(resizeLeftRight)":return"ew-resize";case"(resizeUpDown)":return"ns-resize";case"(resizeUpLeftDownRight)":return"nwse-resize";case"(resizeUpRightDownLeft)":return"nesw-resize";case"(resizeUp)":return"n-resize";case"(resizeDown)":return"s-resize";case"(resizeLeft)":return"w-resize";case"(resizeRight)":return"e-resize";case"(resizeUpLeft)":return"nw-resize";case"(resizeUpRight)":return"ne-resize";case"(resizeDownLeft)":return"sw-resize";case"(resizeDownRight)":return"se-resize";case"(resizeColumn)":return"col-resize";case"(resizeRow)":return"row-resize";case"(zoomIn)":return"zoom-in";case"(zoomOut)":return"zoom-out";default:return"auto"}},e}(i.ComponentView);n.MouseRegion=r},{"../component_view":42,"../dom_utils":44}],33:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Offstage=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{display:e.offstage?"none":"unset"})},e}(i.ComponentView);n.Offstage=r},{"../component_view":42,"../dom_utils":44}],34:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.OpacityAncestor=n.Opacity=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{opacity:e.opacity.toString()})},e}(i.ComponentView);n.Opacity=r;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.target.ancestorStyle.opacity||(this.target.ancestorStyle.opacity=1),this.target.ancestorStyle.opacity*=e.opacity},e}(i.AncestorView);n.OpacityAncestor=s},{"../component_view":42,"../dom_utils":44}],35:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Overlay=void 0;t("../../env");var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.didSetListener=!1,i.additionalConstraints={position:"fixed"},(0,o.setDOMStyle)(i.htmlElement,{position:"fixed",zIndex:"10000",left:"0px",top:"0px",right:"0px",bottom:"0px",touchAction:"none"}),i}return __extends(e,t),e.prototype.supportPageContainer=function(){return!1},e.prototype.elementType=function(){return this.supportPageContainer()?"wx-page-container":"div"},e.prototype.removeFromSuperview=function(){var e,n=this;if(this.supportPageContainer()){if((0,o.setDOMAttribute)(this.htmlElement,"show",!1),!this.superview)return;var i=this.superview.subviews.indexOf(this);return i>=0&&(this.superview.subviews[i].htmlElement.remove(),null===(e=this.superview)||void 0===e||e.subviews.splice(i,1)),void setTimeout((function(){n.htmlElement.remove()}),300)}t.prototype.removeFromSuperview.call(this),this.htmlElement.remove()},e.prototype.setAttributes=function(e){var n=this;t.prototype.setAttributes.call(this,e),this.supportPageContainer()&&((0,o.setDOMAttribute)(this.htmlElement,"show",!0),(0,o.setDOMAttribute)(this.htmlElement,"position","center"),(0,o.setDOMAttribute)(this.htmlElement,"duration","0"),(0,o.setDOMAttribute)(this.htmlElement,"custom-style","position:fixed;z-index:10000;left:0px;top:0px;right:0px;bottom:0px;background-color:transparent;"),(0,o.setDOMAttribute)(this.htmlElement,"overlay-style","background-color:transparent;")),e.onBackgroundTap&&!this.didSetListener&&(this.didSetListener=!0,this.htmlElement.addEventListener("click",(function(t){e.onBackgroundTap&&(!0===e.barrierDismissible&&((0,o.setDOMAttribute)(n.htmlElement,"show",!1),n.htmlElement.remove()),n.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"onBackgroundTap",target:e.onBackgroundTap}})),t.stopPropagation())})),this.supportPageContainer()&&this.htmlElement.addEventListener("afterleave",(function(){n.engine.sendMessage(JSON.stringify({type:"overlay",message:{event:"forceClose",target:n.hashCode}}))})))},e}(i.ComponentView);n.Overlay=r},{"../../env":60,"../component_view":42,"../dom_utils":44}],36:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WidgetSpan=n.TextSpan=n.RichText=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.measuring=!1,e.didSetOnClicked=!1,e.canMeasureResultCache=!1,e.textCache="",e.textCacheSize=0,e}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setConstraints=function(t){this.measuring||t&&(this.constraints=t,this.updateLayout(),(0,o.setDOMStyle)(this.htmlElement,{position:"absolute",opacity:"1"}))},e.prototype.setAttributes=function(e){var n;t.prototype.setAttributes.call(this,e);var i=e.maxWidth;this.maxWidth="string"==typeof i?parseFloat(i):void 0;var s=e.maxHeight;this.maxHeight="string"==typeof s?parseFloat(s):void 0,(0,o.setDOMStyle)(this.htmlElement,{overflow:"hidden",textOverflow:"ellipsis",textAlign:(0,r.cssTextAlign)(e.textAlign),display:!e.maxLines&&e.textAlign?"unset":"-webkit-box",fontSize:"11px",fontFamily:"sans-serif",lineHeight:null===(n=e.height)||void 0===n?void 0:n.toString(),overflowWrap:"anywhere",wordBreak:"break-all",wordWrap:"break-word",whiteSpace:"pre-line",webkitBoxOrient:"vertical",webkitLineClamp:e.maxLines?e.maxLines.toString():"99999"}),this.measureId=e.measureId},e.prototype.setSingleTextSpan=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n,i,s,a=this;return __generator(this,(function(l){if(e={},t[0].attributes.style)for(i in n=(0,r.cssTextStyle)(t[0].attributes.style),this.attributes.selectable&&(delete n.userSelect,delete n.WebkitUserSelect),n)e[i]=n[i];return t[0].attributes.text&&(s=t[0].attributes.text,this.htmlElement.innerText=s,e.letterSpacing||e.wordSpacing||e.height||!1!==/[^㐀-𫠚]/g.test(s)||(this.canMeasureResultCache=!0,this.textCache=s,this.textCacheSize=parseInt(e.fontSize))),t[0].attributes.onTap_el&&t[0].attributes.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(e){a.onClick(t[0].attributes.onTap_el,t[0].attributes.onTap_span),e&&e.stopPropagation()}))),(0,o.setDOMStyle)(this.htmlElement,e),[2]}))}))},e.prototype.setChildren=function(e){var n;return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(i){return e&&1===e.length&&"text_span"===e[0].name&&(null===(n=e[0].attributes)||void 0===n?void 0:n.text)?this.setSingleTextSpan(e):t.prototype.setChildren.call(this,e),[2]}))}))},e.prototype.onClick=function(t,e){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTap",target:t,subTarget:e}}))},e}(i.ComponentView);n.RichText=s;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.didSetOnClicked=!1,e}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setChildren=function(e){e instanceof Array&&e.length>0&&t.prototype.setChildren.call(this,e)},e.prototype.setAttributes=function(e){var n=this;t.prototype.setAttributes.call(this,e);var i={position:"unset",display:"inline"};if(e.style){var s=(0,r.cssTextStyle)(e.style);for(var a in e.selectable&&(delete s.userSelect,delete s.WebkitUserSelect),s)i[a]=s[a]}e.text&&(this.htmlElement.innerText=e.text),e.onTap_el&&e.onTap_span&&!this.didSetOnClicked&&(this.didSetOnClicked=!0,this.htmlElement.addEventListener("click",(function(t){n.onClick(),t&&t.stopPropagation()}))),(0,o.setDOMStyle)(this.htmlElement,i)},e.prototype.onClick=function(){this.attributes.onTap_el&&this.attributes.onTap_span&&this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTap",target:this.attributes.onTap_el,subTarget:this.attributes.onTap_span}}))},e}(i.ComponentView);n.TextSpan=a;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setChildren=function(e){t.prototype.setChildren.call(this,e),this.subviews[0]&&(this.subviews[0].additionalConstraints={position:"relative"},(0,o.setDOMStyle)(this.subviews[0].htmlElement,{position:"relative",display:"inline-flex"}))},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{display:"contents"})},e}(i.ComponentView);n.WidgetSpan=l},{"../component_view":42,"../dom_utils":44,"../utils":57}],37:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.SliverPersistentHeader=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pinned=!0,e.lazying=!1,e.observingScroller=!1,e.lazyOffset=0,e.y=0,e.h=0,e}return __extends(e,t),e.prototype.setAttributes=function(t){this.attributes=t,this.pinned=t.pinned,this.lazying=t.lazying,this.lazyOffset=t.lazyOffset,this.updateLayout(),this.lazying&&!this.observingScroller&&(this.observeScroller(),this.updateLazyState(0))},e.prototype.observeScroller=function(){this.lazying&&!this.observingScroller&&(this.observingScroller=!0)},e.prototype.updateLazyState=function(t){this.lazying&&(0,o.setDOMStyle)(this.htmlElement,{opacity:t>this.lazyOffset?"1.0":"0.0"})},e.prototype.updateLayout=function(){var t,e,n,i,r,s;if(this.constraints){var a=this.constraints.x,l=this.y,c=this.constraints.w,u=this.constraints.h;this.ancestors.forEach((function(t){t.constraints&&(a+=t.constraints.x,l+=t.constraints.y)})),(0,o.setDOMStyle)(this.htmlElement,{position:"sticky",left:null!==(e=null===(t=this.additionalConstraints)||void 0===t?void 0:t.left)&&void 0!==e?e:a+"px",top:this.pinned?this.h+"px":"unset",marginTop:this.pinned?l+"px":"unset",width:null!==(i=null===(n=this.additionalConstraints)||void 0===n?void 0:n.width)&&void 0!==i?i:c+"px",height:null!==(s=null===(r=this.additionalConstraints)||void 0===r?void 0:r.height)&&void 0!==s?s:u+"px",zIndex:"99"})}},e}(i.ComponentView);n.SliverPersistentHeader=r},{"../component_view":42,"../dom_utils":44}],38:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Transform=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{transform:e.transform})},e}(i.ComponentView);n.Transform=r},{"../component_view":42,"../dom_utils":44}],39:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Visibility=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{display:e.visible?"contents":"none"})},e}(i.ComponentView);n.Visibility=r},{"../component_view":42,"../dom_utils":44}],40:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WebDialogs=void 0;t("../../env");var i=function(){function t(){}return t.receivedWebDialogsMessage=function(t,e){this.browserMiniProgramReceivedWebDialogsMessage(t,e)},t.wxMiniProgramReceivedWebDialogsMessage=function(t,e){},t.browserMiniProgramReceivedWebDialogsMessage=function(t,e){},t}();n.WebDialogs=i},{"../../env":60}],41:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.ComponentFactory=void 0;var i=t("./basic/absorb_pointer"),o=t("./basic/clip_oval"),r=t("./basic/clip_r_rect"),s=t("./basic/colored_box"),a=t("./basic/decorated_box"),l=t("./basic/gesture_detector"),c=t("./basic/ignore_pointer"),u=t("./basic/offstage"),d=t("./basic/opacity"),h=t("./basic/transform"),p=t("./basic/image"),f=t("./component_view"),v=t("./mpkit/scaffold"),m=t("./basic/rich_text"),g=t("./basic/list_view"),y=t("./basic/grid_view"),b=t("./basic/custom_scroll_view"),w=t("./basic/custom_paint"),_=t("./mpkit/icon"),P=t("./mpkit/video_view"),x=t("./mpkit/web_view"),S=t("./mpkit/page_view"),M=t("./mpkit/miniprogram_view"),C=t("./basic/overlay"),E=t("./basic/visibility"),A=t("./basic/sliver_persistent_header"),O=t("./basic/editable_text"),R=t("./mpkit/platform_view"),T=t("./basic/foreground_decorated_box"),k=t("../env"),V=t("./mpkit/switch"),D=t("./mpkit/slider"),L=t("./mpkit/picker"),I=t("./mpkit/date_picker"),B=t("./mpkit/circular_progress_indicator"),F=t("./basic/mouse_region"),j=function(){function t(t){this.engine=t,this.cachedView={},this.cachedAncestor={},this.cachedElement={},this.textMeasureResults=[],this.markedNeedsFlushTextMeasureResult=!1}return t.prototype.create=function(e,n){var i;if(e){var o=e["^"],r=e.name,s=e.hashCode;if(1==o&&"number"==typeof s)return this.cachedView[s];if(r&&s){o||(this.cachedElement[s]=e);var a=!t.disableCache&&this.cachedView[s];if(a)return n=a.document,e.ancestors&&a.setAncestors(e.ancestors),e.constraints&&a.setConstraints(e.constraints),e.attributes&&a.setAttributes(e.attributes),e.children&&a.setChildren(this.fetchCachedChildren(e.children)),a;if(n){var l=t.components[r];l||(l=f.ComponentView);var c=new l(n,e.attributes);return(null===(i=k.MPEnv.platformGlobal())||void 0===i?void 0:i.mpDEBUG)&&c.htmlElement.setAttribute("mp-component",r),c.factory=this,c.engine=this.engine,c.hashCode=s,e.ancestors&&c.setAncestors(e.ancestors),e.constraints&&c.setConstraints(e.constraints),e.attributes&&c.setAttributes(e.attributes),e.children&&(t.disableCache?c.setChildren(e.children):c.setChildren(this.fetchCachedChildren(e.children))),t.disableCache||(this.cachedView[s]=c),c}}}},t.prototype.createAncestors=function(e,n){var i=e["^"],o=e.name,r=e.hashCode;if(1==i&&"number"==typeof r)return this.cachedAncestor[r];if(o&&r){i||(this.cachedElement[r]=e);var s=this.cachedAncestor[r];if(s){if(s.target&&s.target!==n){var a=s.target.ancestors.indexOf(s);a>=0&&s.target.ancestors.splice(a,1)}return s.target=n,e.attributes&&s.setAttributes(e.attributes),e.constraints&&s.setConstraints(e.constraints),s}if(n){var l=t.ancestors[o];if(l){var c=new l(n);return e.attributes&&c.setAttributes(e.attributes),e.constraints&&c.setConstraints(e.constraints),this.cachedAncestor[r]=c,c}}}},t.prototype.fetchCachedChildren=function(t){var e=this;return t.map((function(t){var n=t["^"],i=t.hashCode;return n&&e.cachedElement[i]?e.cachedElement[i]:t}))},t.prototype.callbackTextMeasureResult=function(t,e){var n=this;this.textMeasureResults.push({measureId:t,size:e}),this.markedNeedsFlushTextMeasureResult||(this.markedNeedsFlushTextMeasureResult=!0,setTimeout((function(){n.flushTextMeasureResult(),n.markedNeedsFlushTextMeasureResult=!1}),50))},t.prototype.callbackTextPainterMeasureResult=function(t,e){this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onTextPainterMeasured",data:{seqId:t,size:e}}}))},t.prototype.flushTextMeasureResult=function(){this.textMeasureResults.length>0&&(this.engine.sendMessage(JSON.stringify({type:"rich_text",message:{event:"onMeasured",data:this.textMeasureResults}})),this.textMeasureResults=[])},t.components={absorb_pointer:i.AbsorbPointer,clip_oval:o.ClipOval,clip_r_rect:r.ClipRRect,colored_box:s.ColoredBox,custom_paint:w.CustomPaint,custom_scroll_view:b.CustomScrollView,decorated_box:a.DecoratedBox,foreground_decorated_box:T.ForegroundDecoratedBox,editable_text:O.EditableText,gesture_detector:l.GestureDetector,grid_view:y.GridView,ignore_pointer:c.IgnorePointer,image:p.Image,list_view:g.ListView,mouse_region:F.MouseRegion,offstage:u.Offstage,opacity:d.Opacity,overlay:C.Overlay,rich_text:m.RichText,text_span:m.TextSpan,widget_span:m.WidgetSpan,sliver_persistent_header:A.SliverPersistentHeader,transform:h.Transform,visibility:E.Visibility,mp_icon:_.MPIcon,mp_scaffold:v.MPScaffold,mp_video_view:P.MPVideoView,mp_web_view:x.MPWebView,mp_page_view:S.MPPageView,mp_platform_view:R.MPPlatformView,mp_switch:V.MPSwitch,mp_slider:D.MPSlider,mp_picker:L.MPPicker,mp_date_picker:I.MPDatePicker,mp_mini_program_view:M.MPMiniProgramView,mp_circular_progress_indicator:B.MPCircularProgressIndicator},t.ancestors={opacity:d.OpacityAncestor,clip_r_rect:r.ClipRRectAncestor},t.disableCache=!1,t}();n.ComponentFactory=j},{"../env":60,"./basic/absorb_pointer":16,"./basic/clip_oval":17,"./basic/clip_r_rect":18,"./basic/colored_box":20,"./basic/custom_paint":21,"./basic/custom_scroll_view":22,"./basic/decorated_box":23,"./basic/editable_text":24,"./basic/foreground_decorated_box":25,"./basic/gesture_detector":26,"./basic/grid_view":28,"./basic/ignore_pointer":29,"./basic/image":30,"./basic/list_view":31,"./basic/mouse_region":32,"./basic/offstage":33,"./basic/opacity":34,"./basic/overlay":35,"./basic/rich_text":36,"./basic/sliver_persistent_header":37,"./basic/transform":38,"./basic/visibility":39,"./component_view":42,"./mpkit/circular_progress_indicator":45,"./mpkit/date_picker":46,"./mpkit/icon":47,"./mpkit/miniprogram_view":48,"./mpkit/page_view":49,"./mpkit/picker":50,"./mpkit/platform_view":51,"./mpkit/scaffold":52,"./mpkit/slider":53,"./mpkit/switch":54,"./mpkit/video_view":55,"./mpkit/web_view":56}],42:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.AncestorView=n.ComponentView=void 0;var i=t("./dom_utils"),o=function(){function t(t,e){this.document=t,this.initialAttributes=e,this.classname="",this.subviews=[],this.disposed=!1,this.ancestors=[],this.ancestorStyle={},this.htmlElement=t.createElement(this.elementType())}return t.prototype.dispose=function(){this.disposed=!0},t.prototype.elementType=function(){return"div"},t.prototype.setConstraints=function(t){t&&(this.constraints=t,this.updateLayout())},t.prototype.updateLayout=function(){var t,e,n,o,r;if(this.constraints){var s=this.constraints.x,a=this.constraints.y,l=this.constraints.w,c=this.constraints.h;this.ancestors.forEach((function(t){t.constraints&&(s+=t.constraints.x,a+=t.constraints.y)}));var u=this.additionalConstraints;this.collectionViewConstraints&&this.superview&&"CollectionView"===this.superview.classname&&(u=this.collectionViewConstraints),(0,i.setDOMStyle)(this.htmlElement,{position:null!==(t=null==u?void 0:u.position)&&void 0!==t?t:"absolute",left:null!==(e=null==u?void 0:u.left)&&void 0!==e?e:s+"px",top:null!==(n=null==u?void 0:u.top)&&void 0!==n?n:a+"px",width:null!==(o=null==u?void 0:u.width)&&void 0!==o?o:l+"px",height:null!==(r=null==u?void 0:u.height)&&void 0!==r?r:c+"px"})}},t.prototype.setAttributes=function(t){this.attributes=t},t.prototype.setChildren=function(t){var e=this;if(t instanceof Array){var n=t.map((function(t){return e.factory.create(t,e.document)})).filter((function(t){return t})),i=!1,o=-1;if(n.length!==this.subviews.length){i=!0;for(var r=0;r<n.length;r++)if(n[r]!==this.subviews[r]){o=r;break}}else{n.every((function(t,n){return t===e.subviews[n]&&t.superview===e}))||(i=!0)}if(i)if(o>0){var s=[];for(r=o;r<this.subviews.length;r++)s.push(this.subviews[r]);s.forEach((function(t){return t.removeFromSuperview()}));for(r=o;r<n.length;r++)this.addSubview(n[r])}else this.removeAllSubviews(),n.forEach((function(t){return e.addSubview(t)}))}},t.prototype.resetAncestorStyle=function(){this.ancestorStyle.opacity&&(this.ancestorStyle.opacity=1),this.ancestorStyle.borderRadius&&(this.ancestorStyle.borderRadius="unset"),this.ancestorStyle.overflow&&(this.ancestorStyle.overflow="unset"),this.ancestorStyle.borderTopLeftRadius&&(this.ancestorStyle.borderTopLeftRadius="unset"),this.ancestorStyle.borderTopRightRadius&&(this.ancestorStyle.borderTopRightRadius="unset"),this.ancestorStyle.borderBottomLeftRadius&&(this.ancestorStyle.borderBottomLeftRadius="unset"),this.ancestorStyle.borderBottomRightRadius&&(this.ancestorStyle.borderBottomRightRadius="unset")},t.prototype.setAncestors=function(t){var e=this;!(t instanceof Array)&&this.ancestors.length>0?(this.resetAncestorStyle(),this.ancestors=[],(0,i.setDOMStyle)(this.htmlElement,this.ancestorStyle)):(this.resetAncestorStyle(),this.ancestors=t.map((function(t){return e.factory.createAncestors(t,e)})).filter((function(t){return t})),(0,i.setDOMStyle)(this.htmlElement,this.ancestorStyle))},t.prototype.removeAllSubviews=function(){this.subviews.forEach((function(t){t.superview=void 0,t.htmlElement.remove()})),this.subviews=[]},t.prototype.removeFromSuperview=function(){var t;if(this.superview){var e=this.superview.subviews.indexOf(this);e>=0&&(this.superview.subviews[e].htmlElement.remove(),null===(t=this.superview)||void 0===t||t.subviews.splice(e,1)),this.htmlElement.remove()}},t.prototype.addSubview=function(t){t.superview&&t.removeFromSuperview(),this.subviews.push(t),t.superview=this,this.htmlElement.appendChild(t.htmlElement),t.didMoveToWindow()},t.prototype.didMoveToWindow=function(){this.subviews.forEach((function(t){return t.didMoveToWindow()}))},t}();n.ComponentView=o;var r=function(){function t(t){this.target=t}return t.prototype.setConstraints=function(t){t&&(this.constraints=t,this.target.updateLayout())},t.prototype.setAttributes=function(t){},t}();n.AncestorView=r},{"./dom_utils":44}],43:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.wrapDartObject=void 0;n.wrapDartObject=function(t){return null==t||"string"==typeof t||"number"==typeof t||"boolean"==typeof t?t:t instanceof Array?t.map((function(t){return(0,n.wrapDartObject)(t)})):(t.o&&(t=t.o),new Proxy(t,{get:function(t,e){var i,o,r,s,a,l,c,u,d,h,p,f;if("__keys__"===e){var v=[];return(null==t?void 0:t.b)&&v.push.apply(v,Object.keys(t.b)),(null==t?void 0:t.c)&&v.push.apply(v,Object.keys(t.c)),(null==t?void 0:t._nums)&&v.push.apply(v,Object.keys(t._nums)),(null==t?void 0:t._strings)&&v.push.apply(v,Object.keys(t._strings)),v}var m=null!==(f=null!==(d=null!==(l=null!==(r=null===(o=null===(i=null==t?void 0:t.b)||void 0===i?void 0:i[e])||void 0===o?void 0:o.b)&&void 0!==r?r:null===(a=null===(s=null==t?void 0:t.c)||void 0===s?void 0:s[e])||void 0===a?void 0:a.b)&&void 0!==l?l:null===(u=null===(c=null==t?void 0:t._nums)||void 0===c?void 0:c[e])||void 0===u?void 0:u.hashMapCellValue)&&void 0!==d?d:null===(p=null===(h=null==t?void 0:t._strings)||void 0===h?void 0:h[e])||void 0===p?void 0:p.hashMapCellValue)&&void 0!==f?f:t[e];return(0,n.wrapDartObject)(m)}}))}},{}],44:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.setDOMAttribute=n.setDOMStyle=void 0;n.setDOMStyle=function(t,e){if(0!==Object.keys(e).length){for(var n in e){var i=e[n];"string"==typeof i&&i.indexOf(".0px")>0&&(e[n]=i.replace(".0px","px"))}for(var n in e)t.style[n]=e[n]}};n.setDOMAttribute=function(t,e,n){void 0===n?t.removeAttribute(e):t.setAttribute(e,n)}},{}],45:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPCircularProgressIndicator=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s="https://dist.mpflutter.com/res/spinner.svg",a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setChildren=function(){},e.prototype.setAttributes=function(e){var n;t.prototype.setAttributes.call(this,e);var i=null!==(n=e.size)&&void 0!==n?n:36;(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:(0,r.cssColor)(e.color),mask:"url(".concat(s,") no-repeat center"),webkitMask:"url(".concat(s,") no-repeat center"),WebkitMask:"url(".concat(s,") no-repeat center"),width:"65px",height:"65px",transform:"scale(".concat(i/65,", ").concat(i/65,")"),transformOrigin:"top left"})},e}(i.ComponentView);n.MPCircularProgressIndicator=a},{"../component_view":42,"../dom_utils":44,"../utils":57}],46:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPDatePicker=void 0;var i=t("../dom_utils"),o=function(t){function e(e){var n=t.call(this,e)||this;return n}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,i.setDOMAttribute)(this.htmlElement,"header-text",e.headerText),(0,i.setDOMAttribute)(this.htmlElement,"mode","date"),(0,i.setDOMAttribute)(this.htmlElement,"start",e.start),(0,i.setDOMAttribute)(this.htmlElement,"end",e.end),(0,i.setDOMAttribute)(this.htmlElement,"value",e.defaultValue)},e.prototype.showDatePicker=function(t){var e=this;window.weui.datePicker({start:this.attributes.start,end:this.attributes.end,defaultValue:this.attributes.defaultValue.split("-").map((function(t){return parseInt(t)})),onConfirm:function(t){e.invokeMethod("callbackResult",{value:null==t?void 0:t.map((function(t){return t.value}))})},onClose:function(){t.remove()},container:t})},e}(t("../mpkit/platform_view").MPPlatformView);n.MPDatePicker=o},{"../dom_utils":44,"../mpkit/platform_view":51}],47:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPIcon=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.setChildren=function(){},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:(0,r.cssColor)(e.color),mask:"url(".concat(e.iconUrl,") no-repeat center"),webkitMask:"url(".concat(e.iconUrl,") no-repeat center"),WebkitMask:"url(".concat(e.iconUrl,") no-repeat center"),width:"24px",height:"24px",transform:"scale(".concat(e.size/24,", ").concat(e.size/24,")"),transformOrigin:"top left"})},e}(i.ComponentView);n.MPIcon=s},{"../component_view":42,"../dom_utils":44,"../utils":57}],48:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPMiniProgramView=void 0;var i=t("../../components/mpkit/platform_view"),o=t("../dom_utils"),r=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.eventListened={},e}return __extends(e,t),e.prototype.elementType=function(){var t;return"wx-"+(null===(t=this.initialAttributes)||void 0===t?void 0:t.tag)},e.prototype.setAttributes=function(e){for(var n in t.prototype.setAttributes.call(this,e),e)"style"===n?(0,o.setDOMStyle)(this.htmlElement,e[n]):0===n.indexOf("on.")?this.addEventListener(n,e[n]):(0,o.setDOMAttribute)(this.htmlElement,n,e[n])},e.prototype.addEventListener=function(t,e){var n=this;this.eventListened[t]?this.eventListened[t]=e:(this.eventListened[t]=e,this.htmlElement.addEventListener(t.replace("on.",""),(function(e){var i=n.eventListened[t];if(0!==i.length){var o={};i.forEach((function(t){var n;o[t]=null===(n=e.detail)||void 0===n?void 0:n[t]})),n.invokeMethod(t,o)}else n.invokeMethod(t,e.detail)})))},e}(i.MPPlatformView);n.MPMiniProgramView=r},{"../../components/mpkit/platform_view":51,"../dom_utils":44}],49:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPPageView=void 0;var i=t("../mpkit/platform_view"),o=t("../dom_utils"),r=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.wrapperHtmlElement=i.document.createElement("div"),i.direction="horizontal",i.loop=!1,i.autoplay=!1,i.wrapperHtmlElement.className="swiper-wrapper",i.htmlElement.appendChild(i.wrapperHtmlElement),i}return __extends(e,t),e.prototype.setChildren=function(e){t.prototype.setChildren.call(this,e),this.htmlElement.className="swiper-container",this.htmlElement.id="d_"+this.hashCode,this.subviews.forEach((function(t){t.htmlElement.className="swiper-slide",t.htmlElement.style.position="relative"})),this.setupSwiperInstance()},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),this.direction="Axis.vertical"===e.scrollDirection?"vertical":"horizontal",this.loop=e.loop,this.autoplay=e.autoplay,this.wrapperHtmlElement.style.flexDirection="Axis.vertical"===e.scrollDirection?"column":"row",this.setupSwiperInstance()},e.prototype.setupSwiperInstance=function(){var t=this;setTimeout((function(){t.swiperInstance?(t.swiperInstance.changeDirection(t.direction),t.swiperInstance.update()):(t.swiperInstance=new window.Swiper("#d_"+t.hashCode,{direction:t.direction,loop:t.loop,autoplay:t.autoplay,initialSlide:t.attributes.initialPage}),t.swiperInstance.on("activeIndexChange",(function(){t.invokeMethod("onPageChanged",{index:t.swiperInstance.realIndex})})))}),16)},e.prototype.onMethodCall=function(t,e){"animateToPage"===t?this.swiperInstance.slideToLoop(e.page,"number"==typeof e.duration?e.duration:500):"jumpToPage"===t?this.swiperInstance.slideToLoop(e.page,0):"nextPage"===t?this.swiperInstance.slideNext("number"==typeof e.duration?e.duration:500):"previousPage"===t&&this.swiperInstance.slidePrev("number"==typeof e.duration?e.duration:500)},e.prototype.addSubview=function(t){t.superview&&t.removeFromSuperview(),this.subviews.push(t),t.superview=this,this.wrapperHtmlElement.appendChild(t.htmlElement),t.didMoveToWindow()},e}(i.MPPlatformView);!function(t){function e(e,n){var i,o=this;return(o=t.call(this,e,n)||this).document=e,o.initialAttributes=n,o.maxPage=0,o.currentPage=0,o.currentPage=null!==(i=n.initialPage)&&void 0!==i?i:0,o.htmlElement.addEventListener("change",(function(t){o.currentPage=t.detail.current,o.invokeMethod("onPageChanged",{index:t.detail.current})})),n.initialPage&&o.htmlElement.setAttribute("current",n.initialPage),o}__extends(e,t),e.prototype.elementType=function(){return"wx-swiper"},e.prototype.setChildren=function(e){t.prototype.setChildren.call(this,e),this.maxPage=e.length-1},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,o.setDOMAttribute)(this.htmlElement,"vertical","Axis.vertical"===e.scrollDirection),(0,o.setDOMAttribute)(this.htmlElement,"circular",!!e.loop),(0,o.setDOMAttribute)(this.htmlElement,"autoplay",!!e.autoplay)},e.prototype.addSubview=function(t){t.superview&&t.removeFromSuperview(),this.subviews.push(t),t.superview=this;var e=this.document.createElement("wx-swiper-item");e.appendChild(t.htmlElement),this.htmlElement.appendChild(e),t.didMoveToWindow()},e.prototype.onMethodCall=function(t,e){var n=this,i=function(){n.htmlElement.setAttribute("duration","number"==typeof e.duration?e.duration:500),setTimeout((function(){n.htmlElement.setAttribute("current",n.currentPage),n.htmlElement.setAttribute("duration","500")}),16)};"animateToPage"===t?(this.currentPage=e.page,i()):"jumpToPage"===t?(this.currentPage=e.page,e.duration=1,i()):"nextPage"===t?(this.currentPage=this.currentPage+1>this.maxPage?0:this.currentPage+1,i()):"previousPage"===t&&(this.currentPage=this.currentPage-1<0?this.maxPage:this.currentPage-1,i())}}(i.MPPlatformView);n.MPPageView=r},{"../dom_utils":44,"../mpkit/platform_view":51}],50:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPPicker=n.PickerItem=void 0;var i=t("../dom_utils"),o=t("../mpkit/platform_view"),r=function(t,e,n){this.label=t,this.disabled=e,this.subItems=n};n.PickerItem=r;var s=function(t){function e(e,n){var o,r=this;return(r=t.call(this,e,n)||this).initialAttributes=n,r.multiIndex=null!==(o=null==n?void 0:n.defaultValue)&&void 0!==o?o:[0,0,0],r.htmlElement.addEventListener("change",(function(t){r.invokeMethod("callbackResult",{value:"string"==typeof t.detail.value||"number"==typeof t.detail.value?[parseInt(t.detail.value)]:t.detail.value})})),r.htmlElement.addEventListener("columnchange",(function(t){r.updatePickerItem(t.detail.column,t.detail.value),(0,i.setDOMAttribute)(r.htmlElement,"range",r.getPickerItem())})),r}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.getPickerItem=function(){},e.prototype.updatePickerItem=function(t,e){0},e.prototype.showPicker=function(t){},e}(o.MPPlatformView);n.MPPicker=s},{"../dom_utils":44,"../mpkit/platform_view":51}],51:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPPlatformView=void 0;var i=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.document=e,i.initialAttributes=n,i.classname="PlatformView",i.elementType().indexOf("."),null==n||n.tag,i.htmlElement.id="platform_view_"+Math.random().toString(),i.htmlElement.setAttribute("id",i.htmlElement.id),i}return __extends(e,t),e.handleInvokeMethodCallback=function(t,e){this._invokeMethodCompleter[t]&&(this._invokeMethodCompleter[t](e),delete this._invokeMethodCompleter[t])},e.prototype.elementType=function(){return"div"},e.prototype.setSize=function(t){this._currentSize&&this._currentSize.width===t.width&&this._currentSize.height===t.height||(this._currentSize=t,this.engine.sendMessage(JSON.stringify({type:"platform_view",message:{event:"setSize",hashCode:this.hashCode,size:t}})))},e.prototype.createFromWebTemplate=function(){return null},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.onMethodCall=function(t,e){},e.prototype.invokeMethod=function(t,n,i){void 0===i&&(i=!1);var o="".concat(this.hashCode,"_").concat(Math.random());if(this.engine.sendMessage(JSON.stringify({type:"platform_view",message:{event:"methodCall",hashCode:this.hashCode,method:t,params:n,seqId:o,requireResult:i}})),i)return new Promise((function(t){e._invokeMethodCompleter[o]=t}))},e._invokeMethodCompleter={},e}(t("../component_view").ComponentView);n.MPPlatformView=i},{"../component_view":42}],52:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPScaffold=void 0;var i=t("../component_view"),o=t("../dom_utils"),r=t("../utils"),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.attached=!1,e}return __extends(e,t),e.prototype.setAppBar=function(t){this.appBar===t&&!0!==(null==t?void 0:t.collectionViewFixed)||(this.removeAllSubviews(),this.appBar=t,t&&(t.collectionViewFixed=!1,(0,o.setDOMStyle)(t.htmlElement,{pointerEvents:"unset",display:"unset"}),t.subviews.forEach((function(t){(0,o.setDOMStyle)(t.htmlElement,{position:"absolute",marginTop:"0px"})}))),t&&this.engine.pageMode&&(t.additionalConstraints={position:"fixed"},(0,o.setDOMStyle)(t.htmlElement,{position:"fixed",zIndex:"9999"})),this.readdSubviews())},e.prototype.setBody=function(t){this.body!==t&&(this.removeAllSubviews(),this.body=t,this.readdSubviews())},e.prototype.setBottomBar=function(t,e,n){this.bottomBar!==t&&(this.removeAllSubviews(),this.bottomBar=t,t&&this.engine.pageMode&&(t.additionalConstraints={position:"fixed",top:"unset"},(0,o.setDOMStyle)(t.htmlElement,{position:"fixed",top:"unset",bottom:"0px",zIndex:"9999",paddingBottom:!0===e?"env(safe-area-inset-bottom)":"",backgroundColor:n?(0,r.cssColor)(n):void 0})),this.readdSubviews())},e.prototype.setFloatingBody=function(t){this.floatingBody!==t&&(this.removeAllSubviews(),this.floatingBody=t,t&&this.engine.pageMode&&(t.additionalConstraints={position:"fixed",zIndex:"9999"},(0,o.setDOMStyle)(t.htmlElement,{position:"fixed",zIndex:"9999"})),this.readdSubviews())},e.prototype.readdSubviews=function(){this.body&&this.addSubview(this.body),this.appBar&&this.addSubview(this.appBar),this.bottomBar&&this.addSubview(this.bottomBar),this.floatingBody&&this.addSubview(this.floatingBody)},e.prototype.setAttributes=function(e){var n,i,s,a,l;t.prototype.setAttributes.call(this,e),this.setAppBar(e.appBar?this.factory.create(e.appBar,this.document):void 0),this.setBody(e.body?this.factory.create(e.body,this.document):void 0),this.setBottomBar(e.bottomBar?this.factory.create(e.bottomBar,this.document):void 0,e.bottomBarWithSafeArea,e.bottomBarSafeAreaColor),this.setFloatingBody(e.floatingBody?this.factory.create(e.floatingBody,this.document):void 0),e.name?null===(n=this.delegate)||void 0===n||n.setPageTitle(e.name):null===(i=this.delegate)||void 0===i||i.setPageTitle(""),this.delegate?e.backgroundColor?null===(s=this.delegate)||void 0===s||s.setPageBackgroundColor((0,r.cssColorHex)(e.backgroundColor)):null===(a=this.delegate)||void 0===a||a.setPageBackgroundColor("transparent"):(0,o.setDOMStyle)(this.htmlElement,{backgroundColor:e.backgroundColor?(0,r.cssColor)(e.backgroundColor):"unset"}),e.appBarColor&&(null===(l=this.delegate)||void 0===l||l.setAppBarColor((0,r.cssColorHex)(e.appBarColor),e.appBarTintColor?(0,r.cssColorHex)(e.appBarTintColor):"#000000")),this.body&&(this.body.htmlElement.style.touchAction=e.hasRootScroller?"unset":"none")},e.prototype.setDelegate=function(t){this.delegate=t},e.prototype.onRefresh=function(){var t=this;return new Promise((function(e){t.refreshEndResolver=e,t.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onRefresh",target:t.hashCode}}))}))},e.prototype.onWechatMiniProgramShareAppMessage=function(t){var e=this;return new Promise((function(n){e.onWechatMiniProgramShareAppMessageResolver=n,e.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onWechatMiniProgramShareAppMessage",target:e.hashCode,from:null==t?void 0:t.from,webViewUrl:null==t?void 0:t.webViewUrl}}))}))},e.prototype.onWechatMiniProgramShareTimeline=function(){return this.attributes.wechatMiniProgramShareTimeline},e.prototype.onWechatMiniProgramAddToFavorites=function(){return this.attributes.wechatMiniProgramAddToFavorites},e.prototype.onReachBottom=function(){this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onReachBottom",target:this.hashCode}}))},e.prototype.onPageScroll=function(t){this.attributes.onPageScroll&&this.engine.sendMessage(JSON.stringify({type:"scaffold",message:{event:"onPageScroll",target:this.hashCode,scrollTop:t}}))},e.prototype.setChildren=function(){},e}(i.ComponentView);n.MPScaffold=s},{"../component_view":42,"../dom_utils":44,"../utils":57}],53:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPSlider=void 0;t("../dom_utils");var i=function(t){function e(e){var n=t.call(this,e)||this;return n.firstSetup=!0,n.htmlElement.addEventListener("change",(function(t){n.invokeMethod("onValueChanged",{value:t.detail.value})})),n}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.resetSliderValue=function(t){},e.prototype.onMethodCall=function(t,e){if("setValue"===t)null==e||e.value},e}(t("../mpkit/platform_view").MPPlatformView);n.MPSlider=i},{"../dom_utils":44,"../mpkit/platform_view":51}],54:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPSwitch=void 0;t("../dom_utils");var i=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.initialAttributes=n,i.firstSetted=!1,i}return __extends(e,t),e.prototype.elementType=function(){return"div"},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e)},e.prototype.onMethodCall=function(t,e){},e}(t("../mpkit/platform_view").MPPlatformView);n.MPSwitch=i},{"../dom_utils":44,"../mpkit/platform_view":51}],55:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPVideoView=void 0;t("../../env");var i=t("../dom_utils"),o=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.document=e,i.initialAttributes=n,i.id="video_"+Math.random().toString(),i.htmlElement.setAttribute("id",i.id),i}return __extends(e,t),e.prototype.elementType=function(){return"video"},e.prototype.onMethodCall=function(t,e){return __awaiter(this,void 0,void 0,(function(){var n;return __generator(this,(function(i){switch(i.label){case 0:return[3,1];case 1:return[3,5];case 2:return n=this,[4,this.htmlElement.$$getContext()];case 3:n.videoContext=i.sent(),i.label=4;case 4:this.videoContext&&this.onMiniProgramMethodCall(t,e),i.label=5;case 5:return[2]}}))}))},e.prototype.onBrowserMethodCall=function(t,e){},e.prototype.onMiniProgramMethodCall=function(t,e){},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,i.setDOMAttribute)(this.htmlElement,"src",e.url),e.controls&&(0,i.setDOMAttribute)(this.htmlElement,"controls",e.controls),e.autoplay&&(0,i.setDOMAttribute)(this.htmlElement,"autoplay",e.autoplay),e.loop&&(0,i.setDOMAttribute)(this.htmlElement,"loop",e.loop),e.muted&&(0,i.setDOMAttribute)(this.htmlElement,"muted",e.muted),e.poster&&(0,i.setDOMAttribute)(this.htmlElement,"poster",e.poster)},e.prototype.setChildren=function(){},e}(t("./platform_view").MPPlatformView);n.MPVideoView=o},{"../../env":60,"../dom_utils":44,"./platform_view":51}],56:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPWebView=void 0;var i=t("../dom_utils"),o=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.document=e,i.initialAttributes=n,i}return __extends(e,t),e.prototype.elementType=function(){return"iframe"},e.prototype.onMethodCall=function(t,e){"reload"===t?((0,i.setDOMAttribute)(this.htmlElement,"src",""),(0,i.setDOMAttribute)(this.htmlElement,"src",this.attributes.url)):"loadUrl"===t&&(null==e?void 0:e.url)&&((0,i.setDOMAttribute)(this.htmlElement,"src",""),(0,i.setDOMAttribute)(this.htmlElement,"src",e.url))},e.prototype.setAttributes=function(e){t.prototype.setAttributes.call(this,e),(0,i.setDOMAttribute)(this.htmlElement,"src",e.url),(0,i.setDOMStyle)(this.htmlElement,{border:"none"})},e.prototype.setChildren=function(){},e}(t("./platform_view").MPPlatformView);n.MPWebView=o},{"../dom_utils":44,"./platform_view":51}],57:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.cssSizeFromMPElement=n.cssPadding=n.cssTextStyle=n.getBaselineStyle=n.getFontStyleStyle=n.getFontWeightStyle=n.cssTextAlign=n.cssBorder=n.cssOffset=n.cssGradient=n.cssBorderRadius=n.cssColorHex=n.cssColor=void 0;n.cssColor=function(t){var e=parseInt(t),n=(e>>16&255).toString(16);n.length<2&&(n="0"+n);var i=(e>>8&255).toString(16);i.length<2&&(i="0"+i);var o=(e>>0&255).toString(16);o.length<2&&(o="0"+o);var r=(e>>24&255).toString(16);return"ff"===r?"#".concat(n).concat(i).concat(o):(r.length<2&&(r="0"+r),"rgba(".concat(e>>16&255,",").concat(e>>8&255,",").concat(e>>0&255,",").concat((e>>24&255)/255,")"))};n.cssColorHex=function(t){var e=parseInt(t),n=(e>>16&255).toString(16);n.length<2&&(n="0"+n);var i=(e>>8&255).toString(16);i.length<2&&(i="0"+i);var o=(e>>0&255).toString(16);return o.length<2&&(o="0"+o),"#".concat(n).concat(i).concat(o)};n.cssBorderRadius=function(t){var e,n,i,o,r,s,a,l;if(0===t.indexOf("BorderRadius.circular("))return{borderRadius:(c=t.replace("BorderRadius.circular(","").replace(")",""))+"px"};if(0===t.indexOf("BorderRadius.all("))return{borderRadius:(c=t.replace("BorderRadius.all(","").replace(")",""))+"px"};if(0===t.indexOf("BorderRadius.only(")){var c,u=null!==(n=null===(e=(c=t.replace("BorderRadius.only(","").replace(/\)/gi,"").replace(/Radius.circular\(/gi,"")).match(/topLeft: ([0-9|.]+)/))||void 0===e?void 0:e[1])&&void 0!==n?n:0,d=null!==(o=null===(i=c.match(/topRight: ([0-9|.]+)/))||void 0===i?void 0:i[1])&&void 0!==o?o:0,h=null!==(s=null===(r=c.match(/bottomLeft: ([0-9|.]+)/))||void 0===r?void 0:r[1])&&void 0!==s?s:0,p=null!==(l=null===(a=c.match(/bottomRight: ([0-9|.]+)/))||void 0===a?void 0:a[1])&&void 0!==l?l:0;return{borderTopLeftRadius:"".concat(u,"px"),borderTopRightRadius:"".concat(d,"px"),borderBottomLeftRadius:"".concat(h,"px"),borderBottomRightRadius:"".concat(p,"px")}}return{borderRadius:"0px"}};n.cssGradient=function(t){if(!t)return"";if("LinearGradient"===t.classname){var e=function(){switch(t.end){case"centerRight":return"to right";case"centerLeft":return"to left";case"topRight":return"to top right";case"bottomRight":return"to bottom right";case"topLeft":return"to top left";case"bottomLeft":return"to bottom left";case"topCenter":return"to top";case"bottomCenter":return"to bottom"}}(),i=[];return i=t.stops&&t.stops.length?t.colors.map((function(e,i){return void 0!==t.stops[i]?"".concat((0,n.cssColor)(e)," ").concat((100*t.stops[i]).toFixed(0),"%"):(0,n.cssColor)(e)})):t.colors.map((function(t){return(0,n.cssColor)(t)})),"linear-gradient(".concat(e,", ").concat(i.join(", "),")")}return""};n.cssOffset=function(t){if(0===t.indexOf("Offset(")){var e=t.replace("Offset(","").replace(")","").split(",").map((function(t){return t.trim()}));return{dx:e[0],dy:e[1]}}};n.cssBorder=function(t){var e={};return"BorderStyle.none"!==t.topStyle&&(e.borderTopWidth=0===t.topWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):t.topWidth+"px",e.borderTopColor=(0,n.cssColor)(t.topColor),e.borderTopStyle="solid"),"BorderStyle.none"!==t.leftStyle&&(e.borderLeftWidth=0===t.leftWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):t.leftWidth+"px",e.borderLeftColor=(0,n.cssColor)(t.leftColor),e.borderLeftStyle="solid"),"BorderStyle.none"!==t.bottomStyle&&(e.borderBottomWidth=0===t.bottomWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):t.bottomWidth+"px",e.borderBottomColor=(0,n.cssColor)(t.bottomColor),e.borderBottomStyle="solid"),"BorderStyle.none"!==t.rightStyle&&(e.borderRightWidth=0===t.rightWidth?"".concat((1/window.devicePixelRatio).toFixed(2),"px"):t.rightWidth+"px",e.borderRightColor=(0,n.cssColor)(t.rightColor),e.borderRightStyle="solid"),e};function i(t){if(t.fontWeight)return t.fontWeight.replace("FontWeight.w","")}function o(t){if("FontStyle.italic"===t.fontStyle)return"italic"}function r(t){return"TextBaseline.alphabetic"===t.textBaseline?"alphabetic":"TextBaseline.ideographic"===t.textBaseline?"ideographic":"TextBaseline.top"===t.textBaseline?"top":"TextBaseline.middle"===t.textBaseline?"middle":"TextBaseline.bottom"===t.textBaseline?"bottom":void 0}n.cssTextAlign=function(t){var e=null==t?void 0:t.replace("TextAlign.","");return"start"===e?"left":"end"===e?"right":e},n.getFontWeightStyle=i,n.getFontStyleStyle=o,n.getBaselineStyle=r,n.cssTextStyle=function(t){var e,s={userSelect:"none",WebkitUserSelect:"none"};return null!=t&&(t.fontFamily&&(s.fontFamily=t.fontFamily),null!=t.fontSize&&(s.fontSize="".concat((null!==(e=t.fontSize)&&void 0!==e?e:14).toString(),"px")),null!=t.color&&(s.color=(0,n.cssColor)(t.color)),t.fontWeight&&(s.fontWeight=i(t)),t.fontStyle&&(s.fontStyle=o(t)),t.letterSpacing&&(s.letterSpacing=t.letterSpacing),t.wordSpacing&&(s.wordSpacing=t.wordSpacing),t.textBaseline&&(s.alignmentBaseline=r(t)),t.height&&(s.lineHeight=t.height),null!=t.backgroundColor&&(s.backgroundColor=(0,n.cssColor)(t.backgroundColor)),t.decoration&&("TextDecoration.lineThrough"===t.decoration?s.textDecoration="line-through":"TextDecoration.underline"===t.decoration&&(s.textDecoration="underline"))),s};n.cssPadding=function(t){if(!t)return{};if(0===t.indexOf("EdgeInsets.zero"))return{};if(0===t.indexOf("EdgeInsets.all("))return{paddingLeft:(e=t.replace("EdgeInsets.all(","").replace(")",""))+"px",paddingTop:e+"px",paddingRight:e+"px",paddingBottom:e+"px"};if(0===t.indexOf("EdgeInsets(")){var e,n=(e=t.replace("EdgeInsets(","").replace(")","")).split(",").map((function(t){return t.trim()}));return{paddingLeft:n[0]+"px",paddingTop:n[1]+"px",paddingRight:n[2]+"px",paddingBottom:n[3]+"px"}}return{}};n.cssSizeFromMPElement=function(t){if(!t)return{width:0,height:0};var e=0,i=0;if(t.constraints&&"number"==typeof t.constraints.w&&"number"==typeof t.constraints.h&&t.constraints.w>0&&t.constraints.h>0)e=t.constraints.w,i=t.constraints.h;else if(t.children instanceof Array&&1===t.children.length)return(0,n.cssSizeFromMPElement)(t.children[0]);return{width:e,height:i}}},{}],58:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.createDebugger=void 0;var i=t("../env");n.createDebugger=function(t,e){return new r(t,e)};var o=function(){switch(i.MPEnv.platformType){case i.PlatformType.browser:return"browser";case i.PlatformType.wxMiniProgram:return"wechatMiniProgram";case i.PlatformType.swanMiniProgram:return"swanMiniProgram";case i.PlatformType.ttMiniProgram:return"ttMiniProgram";default:return"unknown"}},r=(function(){function t(t,e){this.serverAddr=t,this.engine=e,this.messageQueue=[],this.connected=!1}t.prototype.start=function(){var t=this;i.MPEnv.platformScope.showToast&&i.MPEnv.platformScope.showToast({title:"连接中",icon:"loading",duration:1e4}),this.socket=i.MPEnv.platformScope.connectSocket({url:"ws://".concat(this.serverAddr,"/ws?clientType=").concat(o())}),this.timeoutTimer=setTimeout((function(){t.socket.connected||t.start()}),5e3),this.socket.onOpen((function(){var e;i.MPEnv.platformScope.hideToast&&i.MPEnv.platformScope.hideToast(),clearTimeout(t.timeoutTimer),t.connected=!0,t.socketDidConnect(),null===(e=t.didConnectCallback)||void 0===e||e.call(t)})),this.socket.onMessage((function(e){"string"==typeof e.data&&t.socketDidReceiveMessage(e.data)})),this.socket.onClose((function(){t.connected&&(t.engine.componentFactory.cachedElement={},t.engine.componentFactory.cachedView={},i.MPEnv.platformScope.reLaunch({url:function(){try{return"/"+i.MPEnv.platformScope.getLaunchOptionsSync().path+"?"+t.encodePathParams(i.MPEnv.platformScope.getLaunchOptionsSync().query)}catch(t){return"/pages/index/index"}}()})),t.connected=!1,t.socketDidDisconnect()}))},t.prototype.encodePathParams=function(t){var e=[];if(t)for(var n in t)e.push("".concat(n,"=").concat(encodeURIComponent(t[n])));return e.join("&")},t.prototype.socketDidConnect=function(){var t=this;this.messageQueue.forEach((function(e){var n;null===(n=t.socket)||void 0===n||n.send({data:e})})),this.messageQueue=[]},t.prototype.socketDidDisconnect=function(){var t=this;i.MPEnv.platformScope.showToast&&i.MPEnv.platformScope.showToast({title:"尝试重新连接",icon:"loading",duration:1e4}),clearTimeout(this.timeoutTimer),setTimeout((function(){t.start()}),5e3)},t.prototype.socketDidReceiveMessage=function(t){this.engine.didReceivedMessage(t)},t.prototype.sendMessage=function(t){this.socket&&this.connected?this.socket.send({data:t}):this.messageQueue.push(t)}}(),function(){function t(t,e){this.serverAddr=t,this.engine=e,this.messageQueue=[],this.connected=!1,this.needReload=!1}return t.prototype.start=function(){var t=this,e="ws";"https:"===new URL(location.href).protocol&&(e="wss"),this.socket=new WebSocket("".concat(e,"://").concat(this.serverAddr,"/ws?clientType=").concat(o())),this.socket.onopen=function(){var e;t.needReload?location.href="?":(t.socketDidConnect(),t.connected=!0,null===(e=t.didConnectCallback)||void 0===e||e.call(t))},this.socket.onmessage=function(e){"string"==typeof e.data&&t.socketDidReceiveMessage(e.data)},this.socket.onclose=function(){t.needReload=!0,t.socketDidDisconnect()}},t.prototype.socketDidConnect=function(){var t=this;this.messageQueue.forEach((function(e){var n;null===(n=t.socket)||void 0===n||n.send(e)})),this.messageQueue=[]},t.prototype.socketDidDisconnect=function(){var t=this;setTimeout((function(){t.start()}),1e3)},t.prototype.socketDidReceiveMessage=function(t){this.engine.didReceivedMessage(t)},t.prototype.sendMessage=function(t){this.socket&&1==this.socket.readyState?this.socket.send(t):this.messageQueue.push(t)},t}())},{"../env":60}],59:[function(require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.Engine=void 0;var custom_paint_1=require("./components/basic/custom_paint"),web_dialogs_1=require("./components/basic/web_dialogs"),component_factory_1=require("./components/component_factory"),platform_view_1=require("./components/mpkit/platform_view"),debugger_1=require("./debugger/debugger"),env_1=require("./env"),platform_channel_io_1=require("./platform_channel/platform_channel_io"),mpjs_1=require("./mpjs/mpjs"),text_measurer_1=require("./text_measurer"),window_info_1=require("./window_info"),dart_object_1=require("./components/dart_object"),component_factory_2=require("./canvaskit/component_factory"),Engine=function(){function Engine(){this.started=!1,this.messageQueue=[],this.managedViews={},this.unmanagedViewFrameData={},this.mpJS=new mpjs_1.MPJS(this),this.windowInfo=new window_info_1.WindowInfo(this),this.pageMode=!1,this.componentFactory=new component_factory_1.ComponentFactory(this),this.canvasComponentFactory=new component_factory_2.CanvasComponentFactory(this),this.drawable=new custom_paint_1.MPDrawable(this),this.platformChannelIO=new platform_channel_io_1.PlatformChannelIO(this),this.installWeChatComponentContextGetter()}return Engine.prototype.installWeChatComponentContextGetter=function(){},Engine.codeBlockWithCodePath=function(codePath){return new Promise((function(res,rej){var httpRequest=new XMLHttpRequest;httpRequest.onload=function(){res((function(){eval(httpRequest.response)}))},httpRequest.onerror=function(t){rej(t)},httpRequest.open("GET",codePath),httpRequest.send()}))},Engine.codeBlockWithFile=function(t){return function(){require(t).main()}},Engine.registerPlatformView=function(t,e){component_factory_1.ComponentFactory.components[t]=e},Engine.prototype.initWithDebuggerServerAddr=function(t){this.debugger=(0,debugger_1.createDebugger)(t,this)},Engine.prototype.initWithCodeBlock=function(t){this.codeBlock=t},Engine.prototype.start=function(){var t=this;this.started||(this.codeBlock||this.debugger)&&(this.windowInfo.updateWindowInfo(),this.listenViewport(),env_1.MPEnv.platformGlobal(),env_1.MPEnv.platformGlobal().JSON=JSON,env_1.MPEnv.platformGlobal().setInterval=function(t,e){var n=setInterval(t,e);return parseInt(n)},env_1.MPEnv.platformGlobal().clearTimeout=function(t){clearTimeout(t)},env_1.MPEnv.platformGlobal().clearInterval=function(t){clearInterval(t)},env_1.MPEnv.platformGlobal().engineScope=this.mpJS.engineScope,env_1.MPEnv.platformGlobal().Object=Object,"undefined"!=typeof wx&&(env_1.MPEnv.platformGlobal().wx=wx,env_1.MPEnv.platformGlobal().uni=wx),"undefined"!=typeof swan&&(env_1.MPEnv.platformGlobal().swan=swan,env_1.MPEnv.platformGlobal().uni=swan),"undefined"!=typeof tt&&(env_1.MPEnv.platformGlobal().tt=tt,env_1.MPEnv.platformGlobal().uni=tt),this.debugger&&(this.debugger.didConnectCallback=function(){t.windowInfo.updateWindowInfo()},this.debugger.start()),this.codeBlock&&(this.mpJS.engineScope.onMessage=function(e){t.didReceivedMessage(e)},this.mpJS.engineScope.onMapMessage=function(e){t.didReceivedMessage(e,!0)},t.codeBlock()),this.started=!0)},Engine.prototype.sendMessage=function(t){var e;(null===(e=env_1.MPEnv.platformGlobal())||void 0===e?void 0:e.mpDEBUG)&&console.log((new Date).getTime(),"out",JSON.parse(t)),this.debugger?this.debugger.sendMessage(t):this.mpJS.engineScope.postMessage?this.mpJS.engineScope.postMessage(t):this.messageQueue.push(t)},Engine.prototype.flushQueueMessage=function(){var t=this;this.debugger||this.mpJS.engineScope.postMessage&&this.messageQueue.forEach((function(e){t.mpJS.engineScope.postMessage(e)}))},Engine.prototype.didReceivedMessage=function(t,e){var n,i,o,r,s,a;void 0===e&&(e=!1);var l=e?(0,dart_object_1.wrapDartObject)(t):JSON.parse(t);l&&((null===(n=env_1.MPEnv.platformGlobal())||void 0===n?void 0:n.mpDEBUG)&&console.log((new Date).getTime(),"in",l),"ready"===l.type?this.flushQueueMessage():"frame_data"===l.type?this.didReceivedFrameData(l.message):"diff_data"===l.type?this.didReceivedDiffData(l.message):"element_gc"===l.type?l.message instanceof Array&&this.didReceivedElementGC(l.message):"decode_drawable"===l.type?this.drawable.decodeDrawable(l.message):"custom_paint"===l.type?custom_paint_1.CustomPaint.didReceivedCustomPaintMessage(l.message,this):"route"===l.type?null===(r=null!==(o=null===(i=this.app)||void 0===i?void 0:i.router)&&void 0!==o?o:this.router)||void 0===r||r.didReceivedRouteData(l.message):"mpjs"===l.type?this.didReceivedMPJS(l):"action:web_dialogs"===l.type?web_dialogs_1.WebDialogs.receivedWebDialogsMessage(this,l.message):"scaffold"===l.type?this.didReceivedScaffold(l.message):"scroll_view"===l.type?this.didReceivedScrollView(l.message):"editable_text"===l.type?this.didReceivedEditableText(l.message):"rich_text"===l.type&&"doMeasure"===(null===(s=l.message)||void 0===s?void 0:s.event)?text_measurer_1.TextMeasurer.didReceivedDoMeasureData(this,l.message):"rich_text"===l.type&&"doMeasureTextPainter"===(null===(a=l.message)||void 0===a?void 0:a.event)?text_measurer_1.TextMeasurer.didReceivedDoMeasureTextPainter(this,l.message):"platform_view"===l.type?this.didReceivedPlatformView(l.message):"platform_channel"===l.type&&this.platformChannelIO.didReceivedPlatformChannel(l.message))},Engine.prototype.didReceivedFrameData=function(t){var e;if(t){var n=t.routeId;if(void 0===this.managedViews[n])return this.unmanagedViewFrameData[n]||(this.unmanagedViewFrameData[n]=[]),void this.unmanagedViewFrameData[n].push(t);"number"==typeof n&&(null===(e=this.managedViews[n])||void 0===e||e.didReceivedFrameData(t))}},Engine.prototype.didReceivedDiffData=function(t){var e=this;t&&t.diffs.forEach((function(t){e.componentFactory.create(t,void 0),e.componentFactory.createAncestors(t,void 0)}))},Engine.prototype.didReceivedElementGC=function(t){var e=this;t.forEach((function(t){var n;null===(n=e.componentFactory.cachedView[t])||void 0===n||n.dispose(),delete e.componentFactory.cachedElement[t],delete e.componentFactory.cachedView[t]}))},Engine.prototype.didReceivedScaffold=function(t){var e,n;if("onRefreshEnd"===t.event)(i=this.componentFactory.cachedView[t.target])&&(null===(e=i.refreshEndResolver)||void 0===e||e.call(i,void 0),i.refreshEndResolver=void 0);else if("onWechatMiniProgramShareAppMessageResolve"===t.event){var i;(i=this.componentFactory.cachedView[t.target])&&(null===(n=i.onWechatMiniProgramShareAppMessageResolver)||void 0===n||n.call(i,t.params),i.onWechatMiniProgramShareAppMessageResolver=void 0)}},Engine.prototype.didReceivedScrollView=function(t){var e;if("onRefreshEnd"===t.event)(n=this.componentFactory.cachedView[t.target])&&(null===(e=n.refreshEndResolver)||void 0===e||e.call(n,void 0),n.refreshEndResolver=void 0);else if("jumpTo"===t.event){var n;(n=this.componentFactory.cachedView[t.target])&&n.jumpTo(t.value)}},Engine.prototype.didReceivedEditableText=function(t){var e,n;if("unfocus"===t.event)(i=this.componentFactory.cachedView[t.target])&&(null===(e=i.contentElement)||void 0===e||e.blur());else if("focus"===t.event){var i;(i=this.componentFactory.cachedView[t.target])&&(null===(n=i.contentElement)||void 0===n||n.focus())}},Engine.prototype.didReceivedMPJS=function(t){var e=this;this.mpJS.handleMessage(t.message,(function(n){e.sendMessage(JSON.stringify({type:"mpjs",message:{requestId:t.message.requestId,result:n}}))}),(function(t,n){e.sendMessage(JSON.stringify({type:"mpjs",message:{funcId:t,arguments:n}}))}))},Engine.prototype.didReceivedPlatformView=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n,i;return __generator(this,(function(o){switch(o.label){case 0:return"methodCall"!==t.event?[3,3]:(e=this.componentFactory.cachedView[t.hashCode])?[4,e.onMethodCall(t.method,t.params)]:[3,2];case 1:n=o.sent(),t.requireResult&&this.sendMessage(JSON.stringify({type:"platform_view",message:{event:"methodCallCallback",seqId:t.seqId,result:n}})),o.label=2;case 2:return[3,4];case 3:"methodCallCallback"===t.event&&"string"==typeof(i=t.seqId)&&platform_view_1.MPPlatformView.handleInvokeMethodCallback(i,t.result),o.label=4;case 4:return[2]}}))}))},Engine.prototype.listenViewport=function(){},Engine.prototype.sendViewportChangeEvent=function(){var t=this;this.sendViewportHandler&&clearTimeout(this.sendViewportHandler),this.sendViewportHandler=setTimeout((function(){var e,n;t.windowInfo.updateWindowInfo(),null===(n=null===(e=t.app)||void 0===e?void 0:e.router)||void 0===n||n.history.forEach((function(t){t.item.viewportChanged()})),t.sendViewportHandler=void 0}),32)},Engine}();exports.Engine=Engine},{"./canvaskit/component_factory":13,"./components/basic/custom_paint":21,"./components/basic/web_dialogs":40,"./components/component_factory":41,"./components/dart_object":43,"./components/mpkit/platform_view":51,"./debugger/debugger":58,"./env":60,"./mpjs/mpjs":63,"./platform_channel/platform_channel_io":67,"./text_measurer":70,"./window_info":71}],60:[function(t,e,n){(function(t){(function(){var e;Object.defineProperty(n,"__esModule",{value:!0}),n.MPEnv=n.PlatformType=void 0,function(t){t[t.unknown=0]="unknown",t[t.browser=1]="browser",t[t.wxMiniProgram=2]="wxMiniProgram",t[t.swanMiniProgram=3]="swanMiniProgram",t[t.ttMiniProgram=4]="ttMiniProgram"}(e=n.PlatformType||(n.PlatformType={}));var i={};n.MPEnv={platformType:"undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync?e.swanMiniProgram:"undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync?e.ttMiniProgram:"undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync?e.wxMiniProgram:e.browser,platformScope:"undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync?swan:"undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync?tt:"undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync?wx:void 0,platformAppInstance:void 0,platformGlobal:function(){return n.MPEnv.platformAppInstance?n.MPEnv.platformAppInstance:"function"==typeof getApp?getApp():"undefined"!=typeof window?window:void 0!==t?t:i},platformPC:function(){return!1},platformWindow:function(t){return t&&t.window?t.window:"undefined"!=typeof window?window:void 0},platformByteDance:function(){return"undefined"!=typeof tt}}}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],61:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPEnv=n.ComponentFactory=n.setDOMStyle=n.setDOMAttribute=n.PluginRegister=n.MPEventChannel=n.MPMethodChannel=n.MPPlatformView=n.CanvasApp=n.Page=n.Engine=void 0;var i=t("./engine");Object.defineProperty(n,"Engine",{enumerable:!0,get:function(){return i.Engine}});var o=t("./canvaskit/canvas_page");Object.defineProperty(n,"Page",{enumerable:!0,get:function(){return o.CanvasPage}});var r=t("./canvas_app");Object.defineProperty(n,"CanvasApp",{enumerable:!0,get:function(){return r.CanvasApp}});var s=t("./components/mpkit/platform_view");Object.defineProperty(n,"MPPlatformView",{enumerable:!0,get:function(){return s.MPPlatformView}});var a=t("./platform_channel/mp_method_channel");Object.defineProperty(n,"MPMethodChannel",{enumerable:!0,get:function(){return a.MPMethodChannel}});var l=t("./platform_channel/mp_event_channel");Object.defineProperty(n,"MPEventChannel",{enumerable:!0,get:function(){return l.MPEventChannel}});var c=t("./platform_channel/plugin_register");Object.defineProperty(n,"PluginRegister",{enumerable:!0,get:function(){return c.PluginRegister}});var u=t("./components/dom_utils");Object.defineProperty(n,"setDOMAttribute",{enumerable:!0,get:function(){return u.setDOMAttribute}}),Object.defineProperty(n,"setDOMStyle",{enumerable:!0,get:function(){return u.setDOMStyle}});var d=t("./components/component_factory");Object.defineProperty(n,"ComponentFactory",{enumerable:!0,get:function(){return d.ComponentFactory}});var h=t("./env");Object.defineProperty(n,"MPEnv",{enumerable:!0,get:function(){return h.MPEnv}})},{"./canvas_app":2,"./canvaskit/canvas_page":12,"./components/component_factory":41,"./components/dom_utils":44,"./components/mpkit/platform_view":51,"./engine":59,"./env":60,"./platform_channel/mp_event_channel":65,"./platform_channel/mp_method_channel":66,"./platform_channel/plugin_register":68}],62:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPEnv=n.ComponentFactory=n.setDOMStyle=n.setDOMAttribute=n.PluginRegister=n.MPEventChannel=n.MPMethodChannel=n.MPPlatformView=n.BrowserApp=n.Page=n.Engine=void 0;var i=t("./engine");Object.defineProperty(n,"Engine",{enumerable:!0,get:function(){return i.Engine}});var o=t("./page");Object.defineProperty(n,"Page",{enumerable:!0,get:function(){return o.Page}});var r=t("./browser_app");Object.defineProperty(n,"BrowserApp",{enumerable:!0,get:function(){return r.BrowserApp}});var s=t("./components/mpkit/platform_view");Object.defineProperty(n,"MPPlatformView",{enumerable:!0,get:function(){return s.MPPlatformView}});var a=t("./platform_channel/mp_method_channel");Object.defineProperty(n,"MPMethodChannel",{enumerable:!0,get:function(){return a.MPMethodChannel}});var l=t("./platform_channel/mp_event_channel");Object.defineProperty(n,"MPEventChannel",{enumerable:!0,get:function(){return l.MPEventChannel}});var c=t("./platform_channel/plugin_register");Object.defineProperty(n,"PluginRegister",{enumerable:!0,get:function(){return c.PluginRegister}});var u=t("./components/dom_utils");Object.defineProperty(n,"setDOMAttribute",{enumerable:!0,get:function(){return u.setDOMAttribute}}),Object.defineProperty(n,"setDOMStyle",{enumerable:!0,get:function(){return u.setDOMStyle}});var d=t("./components/component_factory");Object.defineProperty(n,"ComponentFactory",{enumerable:!0,get:function(){return d.ComponentFactory}});var h=t("./env");Object.defineProperty(n,"MPEnv",{enumerable:!0,get:function(){return h.MPEnv}})},{"./browser_app":1,"./components/component_factory":41,"./components/dom_utils":44,"./components/mpkit/platform_view":51,"./engine":59,"./env":60,"./page":64,"./platform_channel/mp_event_channel":65,"./platform_channel/mp_method_channel":66,"./platform_channel/plugin_register":68}],63:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPJS=void 0;var i=t("../env"),o=(t("base64-arraybuffer"),function(){function t(t){this.engine=t,this.engineScope={},this.objectRefs={},this.funcRefs={}}return t.prototype.handleMessage=function(t,e,n){"callMethod"===t.event?this.callMethod(t,e,n):"newObject"===t.event?this.newObject(t,e,n):"getValue"===t.event?this.getValue(t,e):"setValue"===t.event?this.setValue(t,e):"hasProperty"===t.event?this.hasProperty(t,e):"deleteProperty"===t.event&&this.deleteProperty(t,e)},t.prototype.callMethod=function(t,e,n){var i;return __awaiter(this,void 0,void 0,(function(){var o,r,s,a,l=this;return __generator(this,(function(c){switch(c.label){case 0:if(o=t.params,"object"!=typeof(r=this.getCallee(o.objectHandler,o.callChain))&&"function"!=typeof r)return[3,5];c.label=1;case 1:return c.trys.push([1,4,,5]),(s=r[o.method].apply(r,null===(i=o.args)||void 0===i?void 0:i.map((function(t){return l.wrapArgument(t,n)}))))instanceof Promise?[4,s]:[3,3];case 2:s=c.sent(),c.label=3;case 3:return e(this.wrapResult(s)),[3,5];case 4:return a=c.sent(),console.error(a),[3,5];case 5:return[2]}}))}))},t.prototype.newObject=function(t,e,n){var i;return __awaiter(this,void 0,void 0,(function(){var o,r,s,a,l=this;return __generator(this,(function(c){switch(c.label){case 0:if(o=t.params,"object"!=typeof(r=this.getCallee(o.objectHandler,o.callChain))&&"function"!=typeof r)return[3,5];c.label=1;case 1:return c.trys.push([1,4,,5]),(s=new r[o.clazz](null===(i=o.args)||void 0===i?void 0:i.map((function(t){return l.wrapArgument(t,n)}))))instanceof Promise?[4,s]:[3,3];case 2:s=c.sent(),c.label=3;case 3:return e(this.wrapResult(s)),[3,5];case 4:return a=c.sent(),console.error(a),[3,5];case 5:return[2]}}))}))},t.prototype.getValue=function(t,e){return __awaiter(this,void 0,void 0,(function(){var n,i,o;return __generator(this,(function(r){switch(r.label){case 0:return n=t.params,i=this.getCallee(n.objectHandler,n.callChain),(o=i[n.key])instanceof Promise?[4,o]:[3,2];case 1:o=r.sent(),r.label=2;case 2:return e(this.wrapResult(o)),[2]}}))}))},t.prototype.setValue=function(t,e){var n=t.params;this.getCallee(n.objectHandler,n.callChain)[n.key]=n.value,e(void 0)},t.prototype.hasProperty=function(t,e){var n=t.params,i=this.getCallee(n.objectHandler,n.callChain);e(this.wrapResult(i&&i.hasOwnProperty(n.key)))},t.prototype.deleteProperty=function(t,e){var n=t.params,i=this.getCallee(n.objectHandler,n.callChain);i&&delete i[n.key],e(1)},t.prototype.getCallee=function(t,e){var n,o,r,s,a=null!==(n=this.objectRefs[t])&&void 0!==n?n:i.MPEnv.platformGlobal();"engineScope"===e[0]&&(a=this.engineScope,e.shift());for(var l=0;l<e.length;l++){var c=e[l];if(a=a[c],"document"===c&&0===l&&void 0===a&&(a=null===(s=null===(r=null===(o=this.engine)||void 0===o?void 0:o.managedViews)||void 0===r?void 0:r[0])||void 0===s?void 0:s.document),null==a)break}return a},t.prototype.wrapArgument=function(t,e){var n,i=this;if("string"==typeof t&&0===t.indexOf("func:")){var o=t,r=this,s=null!==(n=this.funcRefs[t])&&void 0!==n?n:function(){for(var t=[],n=0;n<arguments.length;n++){var i=arguments[n];t.push(r.wrapResult(i))}e(o,t)};return this.funcRefs[t]=s,s}if("string"==typeof t&&0===t.indexOf("obj:"))return this.objectRefs[t.replace("obj:","")];if("string"!=typeof t||0!==t.indexOf("base64:")){if("object"==typeof t&&t instanceof Array)return t.map((function(t){return i.wrapArgument(t,e)}));if("object"==typeof t){var a={};for(var l in t)a[l]=this.wrapArgument(t[l],e);return a}return t}},t.prototype.wrapResult=function(t){var e=this;if("string"==typeof t||"number"==typeof t||"boolean"==typeof t||"bigint"==typeof t)return t;if(!("object"==typeof t&&t instanceof ArrayBuffer)){if("object"==typeof t&&t instanceof Array)return t.map((function(t){return e.wrapResult(t)}));var n=Math.random().toString();return this.objectRefs[n]=t,{objectHandler:n}}},t}());n.MPJS=o},{"../env":60,"base64-arraybuffer":72}],64:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Page=void 0;var i=t("./components/dom_utils"),o=t("./components/mpkit/scaffold"),r=t("./env"),s=t("./router"),a=function(){function t(t,e,n,i){void 0===i&&(i=null===self||void 0===self?void 0:self.document);var o=this;this.element=t,this.engine=e,this.options=n,this.document=i,this._active=!0,this.viewId=-1,this.overlaysView=[],this.isFirst=!1,this.bodyElement=i.createElement("wx-view"),this.overlayElement=i.createElement("wx-view"),this.bodyElement===t&&this.overlayElement===t||(this.element.appendChild(this.bodyElement),this.element.appendChild(this.overlayElement)),this.requestRoute().then((function(t){var n;o.viewId=t,e.managedViews[o.viewId]=o,e.pageMode=!0,e.unmanagedViewFrameData[o.viewId]&&(e.unmanagedViewFrameData[o.viewId].forEach((function(t){o.didReceivedFrameData(t)})),delete e.unmanagedViewFrameData[o.viewId]),null===(n=o.readyCallback)||void 0===n||n.call(o,void 0)}))}return t.prototype.ready=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return[2,new Promise((function(e){t.readyCallback=e}))]}))}))},t.prototype.requestRoute=function(){var t,e,n,i,o,r;return __awaiter(this,void 0,void 0,(function(){var a,l;return __generator(this,(function(c){switch(c.label){case 0:return this.engine.app||(this.engine.router=new s.Router(this.engine)),a=null!==(e=null===(t=this.engine.app)||void 0===t?void 0:t.router)&&void 0!==e?e:null===(n=this.engine)||void 0===n?void 0:n.router,[3,2];case 1:c.sent(),c.label=2;case 2:return[4,this.fetchViewport()];case 3:return l=c.sent(),[2,a.requestRoute(null!==(o=null===(i=this.options)||void 0===i?void 0:i.route)&&void 0!==o?o:"/",null===(r=this.options)||void 0===r?void 0:r.params,this.isFirst||void 0===this.engine.app,{width:l.width,height:l.height})]}}))}))},t.prototype.delay=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){return[2,new Promise((function(t){setTimeout((function(){t(null)}),1e3)}))]}))}))},t.prototype.fetchViewport=function(){return __awaiter(this,void 0,void 0,(function(){var t,e;return __generator(this,(function(n){switch(n.label){case 0:return e=[{}],[4,this.element.getBoundingClientRect()];case 1:return(!(t=__assign.apply(void 0,e.concat([n.sent()]))).width||t.width<=.1)&&(t.width=window.innerWidth),(!t.height||t.height<=.1)&&(t.height=window.innerHeight),[2,t]}}))}))},t.prototype.dispose=function(){delete this.engine.managedViews[this.viewId]},t.prototype.viewportChanged=function(){var t,e,n;return __awaiter(this,void 0,void 0,(function(){var i,o;return __generator(this,(function(r){switch(r.label){case 0:return(i=null!==(e=null===(t=this.engine.app)||void 0===t?void 0:t.router)&&void 0!==e?e:null===(n=this.engine)||void 0===n?void 0:n.router)?[4,this.fetchViewport()]:[3,2];case 1:o=r.sent(),i.updateRoute(this.viewId,{width:o.width,height:o.height}),r.label=2;case 2:return[2]}}))}))},t.prototype.didReceivedFrameData=function(t){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(n){switch(n.label){case 0:return(!t.overlays||t.overlays&&t.overlays instanceof Array&&0===t.overlays.length)&&this.overlaysView.length>0?(this.overlaysView.forEach((function(t){t.htmlElement.style.visibility="hidden"})),[4,this.removeOverlays()]):[3,2];case 1:n.sent(),n.label=2;case 2:if(!0!==t.ignoreScaffold){if(!((e=this.engine.componentFactory.create(t.scaffold,this.document))instanceof o.MPScaffold))return[2];this.scaffoldView!==e&&(this.scaffoldView&&(this.scaffoldView.attached=!1,this.scaffoldView.htmlElement.remove(),this.scaffoldView.removeFromSuperview()),this.scaffoldView=e,e instanceof o.MPScaffold&&e.delegate),this.scaffoldView&&this.active&&!this.scaffoldView.attached&&(this.scaffoldView.attached=!0,this.bodyElement.appendChild(this.scaffoldView.htmlElement),(0,i.setDOMStyle)(this.scaffoldView.htmlElement,{display:"contents"}))}return t.overlays&&t.overlays instanceof Array&&this.setOverlays(t.overlays),this.miniProgramPage&&!this.miniProgramPage.didReceivedFirstFrame&&(this.miniProgramPage.setData({didReceivedFirstFrame:!0}),this.miniProgramPage.didReceivedFirstFrame=!0),[2]}}))}))},t.prototype.onRefresh=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:return this.scaffoldView instanceof o.MPScaffold?[4,this.scaffoldView.onRefresh()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.onWechatMiniProgramShareAppMessage=function(t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return this.scaffoldView instanceof o.MPScaffold?[4,this.scaffoldView.onWechatMiniProgramShareAppMessage(t)]:[3,2];case 1:return[2,e.sent()];case 2:return[2]}}))}))},t.prototype.onWechatMiniProgramShareTimeline=function(){if(this.scaffoldView instanceof o.MPScaffold)return this.scaffoldView.onWechatMiniProgramShareTimeline()},t.prototype.onWechatMiniProgramAddToFavorites=function(t){if(this.scaffoldView instanceof o.MPScaffold)return this.scaffoldView.onWechatMiniProgramAddToFavorites()},t.prototype.onReachBottom=function(){this.scaffoldView instanceof o.MPScaffold&&this.scaffoldView.onReachBottom()},t.prototype.onPageScroll=function(t){this.scaffoldView instanceof o.MPScaffold&&this.scaffoldView.onPageScroll(t)},t.prototype.removeOverlays=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(e){return[2,new Promise((function(e){t.overlaysView.forEach((function(t){t.removeFromSuperview(),setTimeout((function(){t.htmlElement.remove()}),300)})),t.overlaysView=[],setTimeout((function(){e(null)}),100)}))]}))}))},t.prototype.setOverlays=function(t){var e=this,n=t.map((function(t){return e.engine.componentFactory.create(t,e.document)})).filter((function(t){return t}));n.length===this.overlaysView.length&&n.every((function(t,i){return n[i]===e.overlaysView[i]}))||(this.overlaysView.forEach((function(t){t.removeFromSuperview(),setTimeout((function(){t.htmlElement.remove()}),300)})),n.forEach((function(t){e.overlayElement.appendChild(t.htmlElement)})),this.overlaysView=n)},Object.defineProperty(t.prototype,"active",{get:function(){return this._active},set:function(t){var e;this._active=t,t?(null===(e=this.scaffoldView)||void 0===e?void 0:e.htmlElement)&&(this.element.appendChild(this.scaffoldView.htmlElement),this.scaffoldView.setAttributes(this.scaffoldView.attributes)):this.scaffoldView&&(this.scaffoldView.attached=!1,this.scaffoldView.htmlElement.remove())},enumerable:!1,configurable:!0}),t}();n.Page=a;(function(){function t(t,e){this.document=t,this.scaffoldView=e,this.observingScroller=!1,this.installPageScrollListener()}t.prototype.setPageTitle=function(t){this.document.title=t},t.prototype.setPageBackgroundColor=function(t){this.document.body.style.backgroundColor=t},t.prototype.setAppBarColor=function(t,e){},t.prototype.installPageScrollListener=function(){var t,e=this;t=function(n){if(!e.scaffoldView.htmlElement.isConnected)return e.observingScroller=!1,void window.removeEventListener("scroll",t);e.scaffoldView.onPageScroll(window.scrollY)},this.observingScroller||(this.observingScroller=!0,window.addEventListener("scroll",t))}})(),function(){function t(t,e){this.document=t,this.miniProgramPage=e,this.backgroundElement=this.document.createElement("div"),this.backgroundElementAttached=!1}t.prototype.setPageTitle=function(t){if(r.MPEnv.platformByteDance())return r.MPEnv.platformScope.setNavigationBarTitle({title:t}),void r.MPEnv.platformScope.setNavigationBarColor({frontColor:"#000000",backgroundColor:"#ffffff"});r.MPEnv.platformPC()&&r.MPEnv.platformScope.setNavigationBarTitle({title:t}),this.miniProgramPage.setData({"pageMeta.naviBar.title":t})},t.prototype.setPageBackgroundColor=function(t){if("transparent"===t)return this.backgroundElement.remove(),void(this.backgroundElementAttached=!1);(0,i.setDOMStyle)(this.backgroundElement,{position:"fixed",width:"100vw",height:"100vh",zIndex:"-1",backgroundColor:t}),this.backgroundElementAttached||(this.document.body.appendChild(this.backgroundElement),this.backgroundElementAttached=!0)},t.prototype.setAppBarColor=function(t,e){r.MPEnv.platformByteDance()?r.MPEnv.platformScope.setNavigationBarColor({frontColor:e,backgroundColor:t}):(r.MPEnv.platformPC()&&r.MPEnv.platformScope.setNavigationBarColor({frontColor:e,backgroundColor:t}),this.miniProgramPage.setData({"pageMeta.naviBar.backgroundColor":t,"pageMeta.naviBar.frontColor":e}))}}()},{"./components/dom_utils":44,"./components/mpkit/scaffold":52,"./env":60,"./router":69}],65:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPEventChannel=void 0;var i=function(){function t(){}return t.prototype.onListen=function(t,e){},t.prototype.onCancel=function(t){},t}();n.MPEventChannel=i},{}],66:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.MPMethodChannel=void 0;var i=0;var o=function(){function t(){}return t.prototype.onMethodCall=function(t,e){throw"NOTIMPLEMENTED"},t.prototype.invokeMethod=function(t,e){return __awaiter(this,void 0,void 0,(function(){var n=this;return __generator(this,(function(o){return[2,new Promise((function(o,r){if(n.channelName&&n.engine){var s=++i;n.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"invokeMethod",method:n.channelName,beInvokeMethod:t,beInvokeParams:e,seqId:s}})),n.engine.platformChannelIO.responseCallbacks[s]=[o,r]}}))]}))}))},t}();n.MPMethodChannel=o},{}],67:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PlatformChannelIO=void 0;var i=t(".."),o=t("./plugin_register"),r=function(){function t(t){for(var e in this.engine=t,this.pluginInstances={},this.responseCallbacks={},o.PluginRegister.registedChannels)if(Object.prototype.hasOwnProperty.call(o.PluginRegister.registedChannels,e)){var n=o.PluginRegister.registedChannels[e];try{this.pluginInstances[e]=new n,this.pluginInstances[e].channelName=e,this.pluginInstances[e].engine=t}catch(t){console.error(t)}}}return t.prototype.didReceivedPlatformChannel=function(t){return __awaiter(this,void 0,void 0,(function(){var e,n,o,r,s,a,l,c,u,d=this;return __generator(this,(function(h){switch(h.label){case 0:if("invokeMethod"!==t.event)return[3,7];if(e=t.method,n=t.beInvokeMethod,o=t.beInvokeParams,r=t.seqId,!((s=this.pluginInstances[e])instanceof i.MPMethodChannel))return[3,5];h.label=1;case 1:return h.trys.push([1,3,,4]),[4,s.onMethodCall(n,o)];case 2:return c=h.sent(),this.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackResult",result:c,seqId:r}})),[3,4];case 3:return a=h.sent(),this.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackResult",result:"ERROR:"+a,seqId:r}})),[3,4];case 4:return[3,6];case 5:s instanceof i.MPEventChannel&&("listen"===n?s.onListen(o,(function(t){d.engine.sendMessage(JSON.stringify({type:"platform_channel",message:{event:"callbackEventSink",method:e,result:t,seqId:r}}))})):"cancel"===n&&s.onCancel(o)),h.label=6;case 6:return[3,8];case 7:"callbackResult"===t.event&&(l=t.seqId,c=t.result,void 0!==(u=this.responseCallbacks[l])&&("NOTIMPLEMENTED"===c||"string"==typeof c&&0===c.indexOf("ERROR:")?u[1](c):u[0](c)),delete this.responseCallbacks[l]),h.label=8;case 8:return[2]}}))}))},t}();n.PlatformChannelIO=r},{"..":62,"./plugin_register":68}],68:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.PluginRegister=void 0;var i=t("../components/component_factory"),o=function(){function t(){}return t.registerChannel=function(t,e){this.registedChannels[t]=e},t.registerPlatformView=function(t,e){i.ComponentFactory.components[t]=e},t.registedChannels={},t}();n.PluginRegister=o},{"../components/component_factory":41}],69:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.Router=void 0;var i=function(){function t(t){this.engine=t,this.routeResponseHandler={}}return t.clearBeingPushTimeout=function(){this.beingPushTimeout&&(clearTimeout(this.beingPushTimeout),this.beingPushTimeout=void 0)},t.prototype.updateRoute=function(t,e){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(n){return this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:t,viewport:e}})),[2]}))}))},t.prototype.requestRoute=function(t,e,n,i){return __awaiter(this,void 0,void 0,(function(){var o,r,s=this;return __generator(this,(function(a){return this.thePushingRouteId?(o=this.thePushingRouteId,this.thePushingRouteId=void 0,this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"updateRoute",routeId:o,viewport:i}})),[2,o]):(r=Math.random().toString(),[2,new Promise((function(o){s.routeResponseHandler[r]=o,s.engine.sendMessage(JSON.stringify({type:"router",message:{event:"requestRoute",requestId:r,name:t,params:null!=e?e:{},viewport:i,root:!0===n}}))}))])}))}))},t.prototype.responseRoute=function(t){var e,n=t.requestId,i=t.routeId;null===(e=this.routeResponseHandler[n])||void 0===e||e.call(this,i)},t.prototype.disposeRoute=function(t){this.engine.sendMessage(JSON.stringify({type:"router",message:{event:"disposeRoute",routeId:t}}))},t.prototype.didReceivedRouteData=function(t){var e=t.event;"responseRoute"===e?this.responseRoute(t):"didPush"===e?this.didPush(t):"didReplace"===e?this.didReplace(t):"didPop"===e&&this.didPop()},t.prototype.didPush=function(t){throw"native implementation"},t.prototype.didReplace=function(t){throw"native implementation"},t.prototype.didPop=function(){throw"native implementation"},t.beingPush=!1,t}();n.Router=i},{}],70:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.TextMeasurer=void 0;var i=t("./components/basic/rich_text"),o=t("./canvaskit/basic/text"),r=t("./components/component_factory"),s=t("./components/dom_utils"),a=t("./router"),l=function(){function t(){}return t.delay=function(t){return void 0===t&&(t=1),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){return[2,new Promise((function(e){setTimeout((function(){e(null)}),50*t)}))]}))}))},t.calcMeasureCache=function(t){var e=t.textCache,n=t.textCacheSize,i=this.zhMeasureCache[n]?{measureId:t.attributes.measureId,width:Math.ceil(this.zhMeasureCache[n].width*e.length)+1,height:Math.ceil(this.zhMeasureCache[n].height)+1}:void 0;if(t.constraints&&i&&(i.width<t.constraints.w||0===t.constraints.w))return i},t.saveMeasureCache=function(t,e){var n=t.textCache,i=t.textCacheSize;if(t.constraints&&(t.constraints.w>e.width+44||0===t.constraints.w)){var o={width:e.width/n.length,height:e.height};this.zhMeasureCache[i]=o}},t.didReceivedDoMeasureTextPainter=function(t,e){var n,r,l,c,u,d;return __awaiter(this,void 0,void 0,(function(){var h,p;return __generator(this,(function(f){switch(f.label){case 0:this.activeTextMeasureDocument||(this.activeTextMeasureDocument=document),f.label=1;case 1:return a.Router.beingPush?[4,this.delay()]:[3,3];case 2:return f.sent(),[3,1];case 3:return this.activeTextMeasureDocument?[3,5]:[4,this.delay()];case 4:return f.sent(),[3,3];case 5:return h=new i.RichText(this.activeTextMeasureDocument,{}),new o.Text(this.activeTextMeasureDocument),h.setAttributes({maxWidth:e.maxWidth}),h.setSingleTextSpan([e.text]),(0,s.setDOMStyle)(h.htmlElement,{position:"fixed",top:"0px",left:"0px",opacity:"0",width:"unset",maxWidth:(null===(n=h.attributes)||void 0===n?void 0:n.maxWidth)&&"Infinity"!==(null===(r=h.attributes)||void 0===r?void 0:r.maxWidth)?(null===(l=h.attributes)||void 0===l?void 0:l.maxWidth)+"px":"999999px",height:"unset",maxHeight:(null===(c=h.attributes)||void 0===c?void 0:c.maxHeight)&&"Infinity"!==(null===(u=h.attributes)||void 0===u?void 0:u.maxHeight)?(null===(d=h.attributes)||void 0===d?void 0:d.maxHeight)+"px":"999999px"}),this.activeTextMeasureDocument.body.appendChild(h.htmlElement),[3,7];case 6:f.sent(),f.label=7;case 7:return[4,h.htmlElement.getBoundingClientRect()];case 8:return p=f.sent(),h.htmlElement.remove(),t.componentFactory.callbackTextPainterMeasureResult(e.seqId,p),[2]}}))}))},t.didReceivedDoMeasureData=function(t,e){return __awaiter(this,void 0,void 0,(function(){var n,i,o,l,c,u,d,h,p=this;return __generator(this,(function(f){switch(f.label){case 0:this.activeTextMeasureDocument||(this.activeTextMeasureDocument=document),f.label=1;case 1:return a.Router.beingPush?[4,this.delay()]:[3,3];case 2:return f.sent(),[3,1];case 3:return this.activeTextMeasureDocument?[3,5]:[4,this.delay()];case 4:return f.sent(),[3,3];case 5:n=1,f.label=6;case 6:if(!(n<5))return[3,15];f.label=7;case 7:if(f.trys.push([7,13,,14]),!e.items)return[3,12];for(r.ComponentFactory.disableCache=!0,i=e.items,o=i.map((function(e){return t.componentFactory.create(e,p.activeTextMeasureDocument)})).filter((function(t){return t})),r.ComponentFactory.disableCache=!1,l=[],u=0;u<o.length;u+=100)l.push(o.slice(u,u+100));c=[],u=0,f.label=8;case 8:return u<l.length?(d=l[u],[4,Promise.all(d.map((function(t){return __awaiter(p,void 0,void 0,(function(){var e,n,i,o,r,a,l,c,u,d;return __generator(this,(function(h){switch(h.label){case 0:return t.canMeasureResultCache&&(e=this.calcMeasureCache(t))?[2,e]:((0,s.setDOMStyle)(t.htmlElement,{position:"fixed",top:"0px",left:"0px",opacity:"0",width:"unset",maxWidth:(null===(i=t.attributes)||void 0===i?void 0:i.maxWidth)&&"Infinity"!==(null===(o=t.attributes)||void 0===o?void 0:o.maxWidth)?(null===(r=t.attributes)||void 0===r?void 0:r.maxWidth)+"px":"999999px",height:"unset",maxHeight:(null===(a=t.attributes)||void 0===a?void 0:a.maxHeight)&&"Infinity"!==(null===(l=t.attributes)||void 0===l?void 0:l.maxHeight)?(null===(c=t.attributes)||void 0===c?void 0:c.maxHeight)+"px":"999999px"}),this.activeTextMeasureDocument.body.appendChild(t.htmlElement),[3,2]);case 1:h.sent(),h.label=2;case 2:return[4,t.htmlElement.getBoundingClientRect()];case 3:return n=h.sent(),t.htmlElement.remove(),t.canMeasureResultCache&&this.saveMeasureCache(t,n),[2,{measureId:t.attributes.measureId,width:Math.ceil(null!==(u=null==n?void 0:n.width)&&void 0!==u?u:0)+2,height:Math.ceil(null!==(d=null==n?void 0:n.height)&&void 0!==d?d:0)+1}]}}))}))})))]):[3,11];case 9:h=f.sent(),c.push.apply(c,h),f.label=10;case 10:return u++,[3,8];case 11:return c.forEach((function(e){t.componentFactory.callbackTextMeasureResult(e.measureId,e)})),[3,15];case 12:return[3,14];case 13:return f.sent(),n++,[3,14];case 14:return[3,6];case 15:return[2]}}))}))},t.zhMeasureCache={},t}();n.TextMeasurer=l},{"./canvaskit/basic/text":9,"./components/basic/rich_text":36,"./components/component_factory":41,"./components/dom_utils":44,"./router":69}],71:[function(t,e,n){Object.defineProperty(n,"__esModule",{value:!0}),n.WindowInfo=void 0;t("./env");var i=function(){function t(t){this.engine=t}return t.prototype.updateWindowInfo=function(){this.engine.sendMessage(JSON.stringify({type:"window_info",message:{window:{width:document.body.clientWidth,height:window.innerHeight,padding:{top:0,bottom:0}},devicePixelRatio:devicePixelRatio,darkMode:!0}}))},t}();n.WindowInfo=i},{"./env":60}],72:[function(t,e,n){!function(t,i){"object"==typeof n&&void 0!==e?i(n):"function"==typeof define&&define.amd?define(["exports"],i):i((t="undefined"!=typeof globalThis?globalThis:t||self)["base64-arraybuffer"]={})}(this,(function(t){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="undefined"==typeof Uint8Array?[]:new Uint8Array(256),i=0;i<e.length;i++)n[e.charCodeAt(i)]=i;t.decode=function(t){var e,i,o,r,s,a=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var u=new ArrayBuffer(a),d=new Uint8Array(u);for(e=0;e<l;e+=4)i=n[t.charCodeAt(e)],o=n[t.charCodeAt(e+1)],r=n[t.charCodeAt(e+2)],s=n[t.charCodeAt(e+3)],d[c++]=i<<2|o>>4,d[c++]=(15&o)<<4|r>>2,d[c++]=(3&r)<<6|63&s;return u},t.encode=function(t){var n,i=new Uint8Array(t),o=i.length,r="";for(n=0;n<o;n+=3)r+=e[i[n]>>2],r+=e[(3&i[n])<<4|i[n+1]>>4],r+=e[(15&i[n+1])<<2|i[n+2]>>6],r+=e[63&i[n+2]];return o%3==2?r=r.substring(0,r.length-1)+"=":o%3==1&&(r=r.substring(0,r.length-2)+"=="),r},Object.defineProperty(t,"__esModule",{value:!0})}))},{}]},{},[61])(61)}));
